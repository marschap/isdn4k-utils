  vboxgetty
  Michael Herold, michael@isdn4linux.de
  v3.0, 6. Juli 1998

  Die Dokumentation beschreibt die Installation und Konfiguration von
  _v_b_o_x_g_e_t_t_y. _v_b_o_x_g_e_t_t_y ist Teil des _v_b_o_x Paketes - einem Anrufbeant­
  worter für _i_s_d_n_4_l_i_n_u_x.
  ______________________________________________________________________

  Inhaltsverzeichnis

  1. Copyright

  2. Vorwort

     2.1 Was kann vboxgetty?
     2.2 Was kann vboxgetty nicht?
     2.3 Was wird zum Betrieb benötigt?

  3. Neuerungen

     3.1 Format der Audiodateien
     3.2 Full Duplex Modus
     3.3 Touchtones
     3.4 Mehrere Nummern überwachen
     3.5 Suspend

  4. Installation

     4.1 Anpassung an das lokale System
     4.2 Erzeugen der Programme
     4.3 Installieren der Programme
     4.4 Konfiguration von vboxgetty

  5. Konfiguration

     5.1 vboxgetty.conf
     5.2 vboxgetty.user
     5.3 vboxrc
        5.3.1 CALLERID
        5.3.2 Benutzersektionen
     5.4 Zeitangaben
     5.5 Tagesangaben

  6. Tcl

     6.1 Skripte
        6.1.1 initmodem.tcl
        6.1.2 answercall.tcl
     6.2 Neue Kommandos

  7. vboxgetty

  8. mkvboxuserspool

  9. TODO

  ______________________________________________________________________

  11..  CCooppyyrriigghhtt

  xxx

  22..  VVoorrwwoorrtt

  Das _v_b_o_x-Paket ist eine Erweiterung zu _i_s_d_n_4_l_i_n_u_x und ermöglicht den
  Betrieb eines _i_s_d_n-Anrufbeantworters.

  Das Hauptprogramm des Paketes ist das Programm _v_b_o_x_g_e_t_t_y, das die
  Anrufe entgegennimmt, die Ansagen abspielt und die Nachrichten
  aufzeichnet.

  22..11..  WWaass kkaannnn vvbbooxxggeettttyy??

  Was _v_b_o_x_g_e_t_t_y kann:

  ·  Sprachanrufe entgegennehmen.

  ·  Ansagetexte abspielen und/oder Nachrichten aufzeichnen.

  ·  Touchtones auswerten - mit der eingebauten _T_c_l-Unterstützung sind
     auch komplexe Voicemailboxen möglich.

  Eben alles was ein normaler Anrufbeantworter auch kann - und noch
  einiges mehr...

  22..22..  WWaass kkaannnn vvbbooxxggeettttyy nniicchhtt??

  Was _v_b_o_x_g_e_t_t_y nicht kann:

  ·  Ohne _i_s_d_n_4_l_i_n_u_x betrieben werden. Das _v_b_o_x-Paket ist eine
     Erweiterung zu _i_s_d_n_4_l_i_n_u_x!

  ·  Mit einem Voice-Modem betrieben werden.

  ·  Fax- oder Datenanrufe entgegennehmen. Dazu sind immer noch eigene
     Programme nötig. _v_b_o_x ist ein reiner Anrufbeantworter!

  22..33..  WWaass wwiirrdd zzuumm BBeettrriieebb bbeennööttiiggtt??

  Damit _v_b_o_x_g_e_t_t_y richtig funktioniert, wird folgendes benötigt:

  ·  Eine funktionierende und von _L_i_n_u_x unterstützte _i_s_d_n-Karte.

  ·  Die neuste Version von _i_s_d_n_4_l_i_n_u_x.

  ·  _L_i_n_u_x Kernel ab Version 2.1.103 mit eingeschaltetem _i_s_d_n_4_l_i_n_u_x und
     Isdn-Audio-Support.

  ·  _T_c_l ab Version 8.0.

  Vor der Installation von _v_b_o_x_g_e_t_t_y sollte sichergestellt werden das
  alle benötigten Komponenten installiert sind und auch funktionieren!

  33..  NNeeuueerruunnggeenn

  Hier eine kurze Aufstellung der Neuerungen und Änderungen seit der
  Veröffentlichung von _v_b_o_x Version 2.0.0B4/5.

  Bitte lesen Sie sich die folgenden Abschnitte vor der Installation
  aufmerksam durch, um Unklarheiten und Fehler zu vermeiden!

  33..11..  FFoorrmmaatt ddeerr AAuuddiiooddaatteeiieenn

  Als Format für die Audiodateien wird nur noch _u_l_a_w unterstützt. Die
  Formate _a_l_a_w, _a_d_p_c_m_-_2, _a_d_p_c_m_-_3 und _a_d_p_c_m_-_4 sind zwar noch in
  _i_s_d_n_4_l_i_n_u_x enthalten, finden aber in _v_b_o_x_g_e_t_t_y keine Verwendung mehr.

  Das hat mehrere Gründe:

  ·  Im neu unterstützten _F_u_l_l _D_u_p_l_e_x _M_o_d_u_s (siehe ``Full Duplex
     Modus'') ist ein wechseln des Formates nicht möglich.

  ·  Das Format _u_l_a_w bietet die beste Klangqualität da die Daten nicht
     komprimiert werden.

  ·  Nachrichten können mit einfachen Kommandos wie ``cat name
     >/dev/audio'' ausgegeben werden.

  ·  Die Verwirrung beim Umwandeln der einzelnen Formate entfällt ;-)

  Nachteilig sei hier zu erwähnen, daß dieses Format keine Komprimierung
  macht, die Dateien also u.U. groß werden können.

  Es besteht allerdings die Möglichkeit, diese Dateien mit externen
  Programmen komprimieren zu lassen. Das Abspielen von solchen
  komprimierten Dateien wird von _v_b_o_x_g_e_t_t_y aber zur Zeit noch nicht
  unterstützt, daß heißt alle Ansagetexte, die von _v_b_o_x_g_e_t_t_y gespielt,
  werden müssen in unkomprimierter Form vorliegen!

  Der Header der von früheren _v_b_o_x Versionen vor jede Audiodatei gehängt
  wurde entfällt ab Version 3 komplett. Es werden nur noch die
  Audiodaten selbst gespeichert. Alle weiteren Informationen (wie z.B.
  der Name) werden in einer eigenen Datei abgelegt. Diese Dateien - die
  normalerweise von _v_b_o_x_g_e_t_t_y erzeugt und von _v_b_o_x gelesen werden -
  enden mit dem Kürzel ``.vbox''.

  Wenn Sie Ihre alten Ansagetexte von _v_b_o_x Version 2 beibehalten
  möchten, müssen Sie diese zuerst mit dem _v_b_o_x-Konvertierungsprogramm
  in _u_l_a_w umwandeln und danach den Header entfernen lassen!

  33..22..  FFuullll DDuupplleexx MMoodduuss

  Ab Version 3 arbeitet _v_b_o_x_g_e_t_t_y nur noch im sogenannten _F_u_l_l _D_u_p_l_e_x
  _M_o_d_u_s, der ein gleichzeitiges Abspielen und Aufzeichnen von
  Nachrichten zuläßt.

  In diesem Modus ist es dann zum Beispiel möglich, bereits während dem
  Abspielen des Ansagetextes die Nachricht aufzeichnen zu lassen.

  33..33..  TToouucchhttoonneess

  Touchtones die nur aus einzelnen Zahlen bestehen müssen nicht mehr mit
  ``#'' und ``*'' eingegrenze werden.

  Die Touchtones werden von den _t_c_l-Funktionen jetzt genauso
  zurückgegeben wie sie eingegeben wurden, d.h. einzelne Touchtones als
  einzelne Zahlen und eine Touchtonesequenz in ``#*'' eingefasst.

  33..44..  MMeehhrreerree NNuummmmeerrnn üübbeerrwwaacchheenn

  Dank des neuen AT&L-Kommandos in _i_s_d_n_4_l_i_n_u_x ist es jetzt möglich mit
  einem _v_b_o_x_g_e_t_t_y mehr als eine Nummer anzugeben (mit Wildcards).

  Die Zuweisung welche Nummer für welchen lokalen Benutzer bestimmt ist
  erfolgt über eine seperate Konfigurationsdatei (siehe
  ``vboxgetty.user''). Dort kann jedem lokalen Benutzer eine (oder
  mehrere) Nummer zugewiesen werden. Eingehende Anrufe zu dieser Nummer
  werden dann in den Verzeichnissen des entsprechenden Benutzers
  gepeichert.

  Das in früheren Versionen verwendete Kommando AT&E funktioniert auch
  weiterhin, es kann aber nur eine Nummer angegeben werden!

  33..55..  SSuussppeenndd

  Bereits von _v_b_o_x_g_e_t_t_y angenommene Anrufe können wieder zurück auf die
  Leitung gelegt (Parken) und vom Telefon angenommen werden.

  BBeemmeerrkkuunngg:: Im Moment ist die Nummer zum Parken noch nicht frei
  wählbar, es wird immer 1 benutzt!

  44..  IInnssttaallllaattiioonn

  Die Installation von _v_b_o_x_g_e_t_t_y unterteilt sich in 4 Schritte:

  ·  Anpassung an das lokale System

  ·  Erzeugen der Programme

  ·  Installieren der Programme

  ·  Konfiguration von _v_b_o_x_g_e_t_t_y

  44..11..  AAnnppaassssuunngg aann ddaass llookkaallee SSyysstteemm

  Bevor irgend eines der Programme von _v_b_o_x compiliert oder installiert
  werden kann, muß ``_c_o_n_f_i_g_u_r_e'' aus dem Hauptverzeichnis gestartet
  werden. Das Skript untersucht Ihr System, prüft ob alle benötigten
  Komponenten installiert sind und erzeugt einige Dateien die zur
  Weiterarbeit benötigt werden.

  Das Skript muß nur eeiinnmmaall zu Beginn gestartet werden! Die dort
  gemachten Einstellungen gelten für aallllee Programme des _v_b_o_x-Pakets!

  Über verschiedene Parameter können Sie Voreinstellungen dieses Skripts
  ändern. Eine genaue Auflistung aller möglichen Parameter erhalten Sie,
  wenn Sie in der Shell folgenden Befehl eingeben:

       ./configure --help

  Hier eine Beschreibung der wichtigsten Parameter:

     ----ssbbiinnddiirr==DDIIRR
        DIR legt das Verzeichnis fest, in das _v_b_o_x_g_e_t_t_y (und alle
        weiteren Programme die nur vom Benutzer _r_o_o_t gestartet werden
        können) installiert werden soll. Voreinstellung ist
        ``/usr/local/sbin''. Dieses Verzeichnis wird in der weiteren
        Dokumentation mit <<ssbbiinnddiirr>> beschrieben.

     ----bbiinnddiirr==DDIIRR
        DIR legt das Verzeichnis fest, in das _v_b_o_x (und alle weiteren
        Programme die von jedem Benutzer gestartet werden können)
        installiert werden soll. Voreinstellung ist ``/usr/local/bin''.
        Dieses Verzeichnis wird in der weiteren Dokumentation mit
        <<bbiinnddiirr>> beschrieben.

     ----ddaattaaddiirr==DDIIRR
        DIR gibt das Verzeichnis an, in das die Tcl-Skripte von
        _v_b_o_x_g_e_t_t_y installiert werden sollen. Dort wird automatisch das
        Unterverzeichnis ``vbox'' erzeugt. Voreinstellung ist
        ``/usr/local/share''.  Dieses Verzeichnis wird in der weiteren
        Dokumentation mit <<ppkkggddaattaaddiirr>> beschrieben.

     ----ssyyssccoonnffddiirr==DDIIRR
        DIR legt das Verzeichnis fest, in welches die
        Konfigurationsdateien installiert werden sollen. Voreinstellung
        ist ``/usr/local/etc''.  Dieses Verzeichnis wird in der weiteren
        Dokumentation mit <<ssyyssccoonnffddiirr>> beschrieben.

     ----wwiitthh--llooggddiirr==DDIIRR
        DIR gibt das Verzeichnis an, in welches die Logdateien der
        Programme geschrieben werden sollen. Voreinstellung ist
        ``/var/log''. Dieses Verzeichnis wird in der weiteren
        Dokumentation mit <<llooggddiirr>> beschrieben.

     ----wwiitthh--lloocckkddiirr==DDIIRR
        DIR gibt das Verzeichnis an, in welches die Lockdateien der
        Programme erzeugt werden sollen. Voreinstellung ist
        ``/var/lock''. Dieses Verzeichnis wird in der weiteren
        Dokumentation mit <<lloocckkddiirr>> beschrieben.

     ----wwiitthh--ppiiddddiirr==DDIIRR
        DIR gibt das Verzeichnis an, in welches die Prozeßdateien der
        Programme erzeugt werden sollen. Voreinstellung ist
        ``/var/run''. Dieses Verzeichnis wird in der weiteren
        Dokumentation mit <<ppiiddddiirr>> beschrieben.

  44..22..  EErrzzeeuuggeenn ddeerr PPrrooggrraammmmee

  Alle Programme des _v_b_o_x-Pakets können mit

       make

  aus dem Hauptverzeichnis erzeugt werden. Um nur einzelne Programme zu
  erzeugen muß ``_m_a_k_e'' im jeweiligen Verzeichnis aufgerufen werden.

  Wenn Sie z.B. nur _v_b_o_x_g_e_t_t_y erzeugen möchten, wechseln Sie in das
  Verzeichnis von _v_b_o_x_g_e_t_t_y und startet dort ``_m_a_k_e''.

  44..33..  IInnssttaalllliieerreenn ddeerr PPrrooggrraammmmee

  Alle Programme des _v_b_o_x-Pakets können mit

       make install

  aus dem Hauptverzeichnis installiert werden. Um nur einzelne Programme
  zu installieren muß ``_m_a_k_e _i_n_s_t_a_l_l'' im jeweiligen Verzeichnis
  aufgerufen werden.

  Wenn Sie z.B. nur _v_b_o_x_g_e_t_t_y installieren möchten, wechseln Sie in das
  Verzeichnis von _v_b_o_x_g_e_t_t_y und startet dort ``_m_a_k_e _i_n_s_t_a_l_l''.

  Bevor die Programme installiert werden können, müssen sie mit ``_m_a_k_e''
  (siehe ``Erzeugen der Programme'') erzeugt werden. Ein ``_m_a_k_e
  _i_n_s_t_a_l_l'' erzeugt nniicchhtt aallllee Programme!

  Wenn eine Datei die installiert werden soll bereits existiert, wird
  die alte Datei nniicchhtt überschrieben! Die neue Datei wird stattdessen
  mit der Endung ``.new'' installiert!

  44..44..  KKoonnffiigguurraattiioonn vvoonn vvbbooxxggeettttyy

  Bevor Sie _v_b_o_x_g_e_t_t_y zum erstenmal nutzen können, müssen erst einige
  Einstellungen gemacht werden.

  Es werden drei Konfigurationsdateien benutzt:

     vvbbooxxggeettttyy..ccoonnff
        Mit dieser Datei wird der getty selbst konfiguriert. Hier kann
        u.A. eingestellt werden welches Device benutzt werden soll und
        wie es initialisiert wird.

     vvbbooxxggeettttyy..uusseerr
        Mit dieser Datei wird festgelegt, welche lokale Telefonnummer
        welchem Benutzer zugewiesen wird.

     vvbbooxxrrcc
        Diese Datei enthält Einstellungen des jeweiligen Benutzers. Hier
        wird festgelegt welche Anrufe wann und wie entgegengenommen
        werden sollen.

  Die jeweils möglichen Einstellungen können Sie unter ``Konfiguration''
  nachlesen.

  Wie _v_b_o_x_g_e_t_t_y selbst gestartet werden kann, lesen Sie bitte unter
  ``vboxgetty'' nach.

  55..  KKoonnffiigguurraattiioonn

  55..11..  vvbbooxxggeettttyy..ccoonnff

  Die Datei ``_<_s_y_s_c_o_n_f_d_i_r_>_/_v_b_o_x_g_e_t_t_y_._c_o_n_f'' dient zur globalen
  Einstellung eines _v_b_o_x_g_e_t_t_y.

  Die Einstellungen können wie folgt angegeben werden:

       name = value

  Wobei ``nnaammee'' für die zu setzende Variable und ``vvaalluuee'' für den zu
  setzenden Wert steht. Vor und nach dem ``='' kann mit Leerzeichen oder
  Tabulatoren getrennt werden. Kommentare am Ende einer Zeile sind nicht
  möglich!.

  Leere Zeilen und solche die mit einem ``#'' beginnen werden überlesen.
  Eine Zeile darf nicht länger als 200 Zeichen werden!

  Für ``nnaammee'' können folgende Schlüsselworte verwendet werden:

     iinniitt
        Kommando mit dem das Modem initialisiert werden soll.
        Voreinstellung ist ATZ&B512.

     iinniittnnuummbbeerr
        Kommando mit dem die Nummern eingestellt werden sollen auf die
        _v_b_o_x_g_e_t_t_y reagieren soll. Hierzu kann der neue AT-Befehl
        ``AT&L'' verwendet werden. Bei diesem Befehl können mehrere
        Nummern durch ``;'' getrennt angegeben werden. Zudem sind
        einfache Musterangaben wie ``*'' und ``?'' möglich. Der in
        früheren Versionen benutzte Befehl ``AT&E'' kann ebenfalls
        wieder verwendet werden. Es existiert keine Voreinstellung!

     bbaaddiinniittsseexxiitt
        Gibt an, nach wievielen fehlerhaften Modeminitalisierungen sich
        _v_b_o_x_g_e_t_t_y beenden soll. Voreinstellung ist 10 mal.

     ccoommmmaannddttiimmeeoouutt
        Anzahl Sekunden die maximal auf die Antwort eines Modemkommandos
        gewartet werden soll. Voreinstellung ist 4 Sekunden.

     eecchhoottiimmeeoouutt
        Anzahl Sekunden die maximal auf das Echo eines Modemkommandos
        gewartet werden soll. Voreinstellung ist 4 Sekunden.

     rriinnggttiimmeeoouutt
        Anzahl der Sekunden die maximal auf einen RING gewartet werden
        soll. Voreinstellung ist 6 Sekunden.

     aalliivveettiimmeeoouutt
        Anzahl der Sekunden nach denen überprüft werden soll ob das
        Modem noch antwortet. Die Überprüfung erfolgt nur, wenn
        innerhalb dieser Zeit keine Aktivität vom Modem festgestellt
        wurde. Voreinstellung ist 1800 Sekunden.

     ttoogggglleeddttrrttiimmee
        Anzahl der Millisekunden die die DTR-Leitung auf Low gelegt
        werden soll um das Modem aufzulegen. Voreinstellung ist 400
        Millisekunden.

     ssppoooollddiirr
        Angabe wo sich die Spoolverzeichnisse der Benutzer befinden.
        Voreinstellung ist /var/spool/vbox.

  Die Datei ``_v_b_o_x_g_e_t_t_y_._c_o_n_f'' wird von jjeeddeemm _v_b_o_x_g_e_t_t_y eingelesen.

  Nach abarbeitung dieser Datei wird versucht ``_v_b_o_x_g_e_t_t_y_._c_o_n_f_._<_t_t_y_>''
  zu laden (wobei _<_t_t_y_> für den Namen des von _v_b_o_x_g_e_t_t_y verwendeten
  tty's steht). Existiert diese Datei, können damit die Einstellungen
  aus ``_v_b_o_x_g_e_t_t_y_._c_o_n_f'' überschrieben werden!

  Beispiel der Datei ``_v_b_o_x_g_e_t_t_y_._c_o_n_f'':

  # Global vboxgetty configuration. Please take a look at the documentation
  # to learn how the configuration work!

  init            AT&B512
  spooldir        /var/spool/vbox

  Beispiel der Datei ``_v_b_o_x_g_e_t_t_y_._c_o_n_f_._t_t_y_I_0'':

       # vboxgetty configuration for ttyI0. Please take a look at the
       # documentation to learn how the configuration work!

       initnumber      AT&L784711;784712;78471[34];78472?

  55..22..  vvbbooxxggeettttyy..uusseerr

  Ab Version 3 von _v_b_o_x kann ein _v_b_o_x_g_e_t_t_y mittels des Kommandos AT&L
  mehrere Nummern überwachen (siehe auch ``vboxgetty.conf'').

  Über die Datei ``_<_s_y_s_c_o_n_f_d_i_r_>_/_v_b_o_x_g_e_t_t_y_._u_s_e_r'' wird festgelegt, welche
  Telefonnummer welchem lokalen Benutzer zugeordnet ist.

  Bei einem eingehenden Anruf wird die angerufene Nummer in dieser Datei
  gesucht und der Anruf einem lokalen Benutzer zugeordnet. Danach werden
  die Rechte des _v_b_o_x_g_e_t_t_y auf diesen Benutzer gesetzt und alle weiteren
  Operationen werden unter diesen Rechten vorgenommen.

  Jede Zuordnung beginnt in einer neuen Zeile und hat folgendes Format:

       number:user:group:umask:space

  Kommentare (mit dem Zeichen ``#'' am Zeilenanfang eingeleitet) und
  leere Zeilen werden überlesen. Eine einzelne Zeile darf nicht länger
  als 200 Zeichen werden!

     nnuummbbeerr
        Hier wird die Telefonnummer definiert, die einem Benutzer
        zugeordnet werden soll. Es können einfache Muster angegeben
        werden (siehe _f_n_m_a_t_c_h_(_3_)).  Eine Angabe von ``*'' gilt für aallllee
        Nummern. Das Feld mmuußß angegeben werden!

     uusseerr
        Lokaler Benutzer dem die Nummer zugeordnet werden soll. Der
        Benutzer kann namentlich oder als UID (eingeleitet mit einem
        ``#'') angegeben werden.  Das Feld mmuußß angegeben werden!

     ggrroouupp
        Gruppe die für den Benutzer gesetzt werden soll. Die Gruppe kann
        namentlich oder als GID (eingeleitet mit einem ``#'') angegeben
        werden.  Bei einem leeren Feld wird keine Gruppe gesetzt. Das
        Feld ist optional und muß nicht angegeben werden.
     uummaasskk
        Die Maske die zum anlegen von neuen Dateien oder Verzeichnissen
        benutzt werden soll. Bei einem leeren Feld wird die Maske
        (umask) nicht gesetzt. Das Feld ist optional und muß nicht
        angegeben werden.

     ssppaaccee
        Freier Platz in Bytes, der auf der Partition auf der sich das
        _<_s_p_o_o_l_d_i_r_> (siehe ``vboxgetty.conf'') des Benutzers befindet
        frei sein muß, damit der Anruf angenommen wird. Bei einem leeren
        Feld oder ``0'' wird keine Überprüfung des freien Platzes
        gemacht. Das Feld ist optional und muß nicht angegeben werden.

  Ein eingehender Anruf wird nniicchhtt angenommen, wenn die Datei nicht
  existiert oder der angerufenen Nummer kein Benutzer zugeordnet werden
  konnte!

  Beispiel der Datei ``_v_b_o_x_g_e_t_t_y_._u_s_e_r'':

       # Number to user mapping. Please read the documentation to learn how this
       # configuration file work!
       #
       # The fields "number" and "user" *must* be set - all others are optional!
       #
       # Format: number:user:group:umask:freespace

       784711:peter::0077:2000000
       784712:willy:firma:0007:2000000
       78471?:firma:firma:0007:4000000
       *:#100:#500:0077:

  55..33..  vvbbooxxrrcc

  Die Datei ``_v_b_o_x_r_c'' muß für jeden Benutzer existieren (ansonsten wird
  der Anruf nicht angenommen) und befindet sich im Spoolverzeichnis des
  Benutzers (_<_s_p_o_o_l_d_i_r_>_/_<_u_s_e_r_n_a_m_e_>).

  Die Datei setzt sich aus mehreren Sektionen zusammen. Eine Sektion
  beginnt mit dem Zeichen ``['' gefolgt vom Sekionsnamen und wird mit
  dem Zeichen ``]'' abgeschlossen. Die Sektion zählt bis zum nächsten
  Sektionsbeginn oder dem Ende der Datei.

  Leere Zeilen oder solche die mit einem ``#'' beginnen werden
  überlesen. Eine Zeile darf nicht länger als 200 Zeichen werden!

  Mit dem Kommando ``_m_k_v_b_o_x_u_s_e_r_s_p_o_o_l'' (siehe ``mkvboxuserspool'')
  können Spoolverzeichnisse für einzelne Benutzer angelegt werden. Der
  Befehl erzeugt zudem ein Beispiel der Datei ``_v_b_o_x_r_x''. Die Datei wird
  dabei so angelegt, das jeder Anruf nach 5x Klingeln beantwortet wird.

  Hier ein Beispiel der Datei ``_v_b_o_x_r_c'':

  [CALLERID]

  931784711      -         Michael 'Ghandi' Herold
  93178471?      -         Nicole Sauvage
  *              *         *** Unknown ***

  [Michael 'Ghandi' Herold]
  *               *       answercall.tcl    240      4       0

  [Nicole Sauvage]
  *               *       answercall.tcl    120      4       0

  [DEFAULT]

  00:00-09:59     *       answercall.tcl    120      1       0
  *               *       answercall.tcl     90      6       4

  Bevor die Datei ``_v_b_o_x_r_c'' geladen wird, wird nach der Datei
  ``_v_b_o_x_r_c_._<_l_o_c_a_l_p_h_o_n_e_>'' gesucht (_<_l_o_c_a_l_p_h_o_n_e_> entspricht dabei der
  lokalen Telefonnummer die angerufen wurde).

  Existiert diese Datei, wie sie anstelle von ``_v_b_o_x_r_c'' benutzt!

  Im weiteren werden hier die einzelnen möglichen Sektionen beschrieben.

  55..33..11..  CCAALLLLEERRIIDD

  In der Sektion ``[CALLERID]'' wird festgelegt, welche Nummer welcher
  Person zugeordnet wird und welche Einstellungen benutzt werden sollen
  wenn ein Anruf von dieser Person eingeht.

  Einträge in dieser Sektion beginnen jeweils in einer neuen Zeile und
  werden wie folgt angegeben:

       number section name

  Die einzelnen Angaben müssen mit Leerzeichen oder Tabulator
  voneinander getrennt werden. Die Felder ``_n_u_m_b_e_r'' und ``_s_e_c_t_i_o_n''
  dürfen selbst keine Leerzeichen oder Tabulatoren enthalten!

     nnuummbbeerr
        Nummer der jeweiligen Person. Es können einfache Muster
        angegeben werden (siehe _f_n_m_a_t_c_h_(_3_)). Die Nummer muß jeweils so
        angegeben werden wie sie von _i_s_d_n_4_l_i_n_u_x übermittelt wird.

     sseeccttiioonn
        Name der Benutzersektion die bei einem Anruf dieser Person
        verwendet werden soll. Wird hier ein ``*'' angegeben, wird die
        Sektion ``[DEFAULT]'' benutzt; bei einem ``-'' wird ``_n_a_m_e'' als
        Name der Benutzersektion verwendet. Alle anderen Angaben werden
        als Name der Benutzersektion gewertet.

     nnaammee
        Name der jeweiligen Person. Dieser Name wird z.B. in die von
        _v_b_o_x_g_e_t_t_y erzeugten ``.vbox'' Dateien geschrieben.

  55..33..22..  BBeennuuttzzeerrsseekkttiioonneenn

  Benutzersektionen werden auf die gleiche Art definiert wie die fest
  von _v_b_o_x_g_e_t_t_y benutzen Sektionen. Sie beginnen mit einem ``['' gefolgt
  von einem frei wählbaren Namen und werden mit einem ``]''
  abgeschlossen.

  Einträge in dieser Sektion beginnen jeweils in einer neuen Zeile und
  werden wie folgt angegeben:

       time day scriptname savetime ringring tollring

  Die einzelnen Angaben müssen mit Leerzeichen oder Tabulator
  voneinander getrennt werden.

     ttiimmee
        Zeiten zu denen diese Einstellungen benutzt werden sollen. Das
        genaue Format einer Zeitangabe kann unter ``Zeitangaben''
        nachgelesen werden.

     ddaayy
        Tage an denen diese Einstellungen benutzt werden sollen. Das
        genaue Format einer Tagesangabe kann unter ``Tagesangaben''
        nachgelesen werden.

     ssccrriippttnnaammee
        Name des _T_c_l-Skriptes das zum beantworten dieses Anrufes benutzt
        werden soll. Pfadangaben im Skriptnamen werden automatisch
        entfernt. Das Skript wird zuerst im Verzeichnis
        ``_<_s_p_o_o_l_d_i_r_>_/_<_u_s_e_r_n_a_m_e_>_/_t_s_c_r_i_p_t_s'' und danach in
        ``_<_p_k_g_d_a_t_a_d_i_r_>'' gesucht (siehe auch ``answercall.tcl'').

     ssaavveettiimmee
        Maximale Aufzeichnungszeit in Sekunden. Die Angabe wird dem
        Skript ``_s_c_r_i_p_t_n_a_m_e'' als Variable übergeben und kann dort
        benutzt werden.

     rriinnggrriinngg
        Anzahl der Klingelzeichen nach denen der Anruf beantwortet
        werden soll. Wird hier 0 angegeben, wird der Anruf ignoriert.

     ttoollllrriinngg
        Anzahl der Klingelzeichen nach denen der Anruf beantwortet
        werden soll, wenn im Spoolverzeichnis des jeweiligen Benutzers
        noch neue Nachrichten liegen. Wenn hier 0 angegeben wird, wird
        nicht geprüft ob neue Nachrichten vorhanden sind; es gelten dann
        die Angaben von ``_r_i_n_g_r_i_n_g''.

  55..44..  ZZeeiittaannggaabbeenn

  Einzelne Zeitangaben werden durch Kommata getrennt, Angaben von Start-
  und Endzeit durch ein Minuszeichen. Die Stundenangaben müssen im
  24-Stunden-Format - also von 0 Uhr bis 23 Uhr - gemacht werden.

  Die Zeitangaben werden intern immer in Start- und Endzeit umgerechnet,
  auch dann, wenn nur eine Startzeit angegeben ist.

  Nehmen wir zum Beispiel folgende Zeitangaben:

  20:15-21:14

  Diese Zeit wird intern in 20:15:00-21:14:59 umgerechnet, d.h. Start-
  und Endzeit sind iinnkklluussiivvee!

  Wenn bei einer Zeitangabe keine Minuten angebenen sind, wird bei der
  Startzeit 0 Minuten und bei der Endzeit 59 Minuten benutzt. Intern
  werden die Sekunden - die nicht einstellbar sind - nach dem gleichen
  Schema behandelt.

     BBeeiissppiieell::

     ·  20          - Umrechnung nach 20:00:00-20:59:59

     ·  20:15-21:14 - Umrechnung nach 20:15:00-21:14:59

     ·  08-11       - Umrechnung nach 08:00:00-11:59:59

     ·  12-15:30    - Umrechnung nach 12:00:00-15:30:59

  Eine Zeitzone zählt als zutreffend (match) wenn die aktuelle Zeit
  größer/gleich der Startzeit uunndd kleiner/gleich der Endzeit ist.

  Ein ``*'' als eeiinnzziiggee Zeitangabe wird als iimmmmeerr behandelt, ein ``-''
  als eeiinnzziiggee Zeitangabe als nniiee.

  55..55..  TTaaggeessaannggaabbeenn

  Einzelne Tagesangaben werden durch Kommanta getrennt. Eine Angabe von
  Start- und Ende ist hier nicht möglich.

  Folgende Tageskürzel können angegeben werden:

  ·  MO, MON - für Montag

  ·  DI, TUE - für Dienstag

  ·  MI, WED - für Mittwoch

  ·  DO, THU - für Donnerstag

  ·  FR, FRI - für Freitag

  ·  SA, SAT - für Samstag

  ·  SO, SUN - für Sonntag

  Eine Angabe von ``*'' als eeiinnzziiggee Tagesangabe heißt iimmmmeerr, ein ``-''
  als eeiinnzziiggee Tagesangabe nniiee.

  66..  TTccll

  66..11..  SSkkrriippttee

  Seit Version 2 unterstützt _v_b_o_x_g_e_t_t_y die Verwendung von _T_c_l-Skripten,
  die während der Laufzeit ausgeführt werden können.

  Die Standard-Skripte von _v_b_o_x_g_e_t_t_y befinden sich im Verzeichnis
  ``_<_p_k_g_d_a_t_a_d_i_r_>''.

  66..11..11..  iinniittmmooddeemm..ttccll

  Das Skript ``_i_n_i_t_m_o_d_e_m_._t_c_l'' wird jedesmal gestartet, wenn das Modem
  initialisiert werden soll.

  Liefert die Ausführung des Skripts einen Fehler zurück, gilt die
  Initialisierung als Fehlgeschlagen.

  Das Skript wird nur in ``_<_p_k_g_d_a_t_a_d_i_r_>'' gesucht.

  Folgende Variablen werden von _v_b_o_x_g_e_t_t_y definiert und können verwendet
  werden:

     vvbbxxvv__iinniitt
        Das in ``_v_b_o_x_g_e_t_t_y_._c_o_n_f'' eingestellte Initkommando ``_i_n_i_t''.

     vvbbxxvv__iinniittnnuummbbeerr
        Das in ``_v_b_o_x_g_e_t_t_y_._c_o_n_f'' eingestellte Initkommando
        ``_i_n_i_t_n_u_m_b_e_r''.

  AAcchhttuunngg:: Das Skript wird unter rroooott-Rechten ausgeführt und sollte
  daher nicht von normalen Benutzern änderbar sein!

  66..11..22..  aannsswweerrccaallll..ttccll

  Das Skript ``_a_n_s_w_e_r_c_a_l_l_._t_c_l'' (der Name kann sich je nach ``_v_b_o_x_r_c''
  ändern) wird aufgerufen, nachdem der eingegangene Anruf beantwortet
  wurde.

  Das Skript wird zuerst im Verzeichnis
  ``_<_s_p_o_o_l_d_i_r_>_/_<_u_s_e_r_n_a_m_e_>_/_t_s_c_r_i_p_t_s'' und danach in ``_<_p_k_g_d_a_t_a_d_i_r_>''
  gesucht.

  In diesem Skript werden die Ansagetexte abgespielt, Nachrichten
  aufgezeichnet und die Touchtones ausgewertet.

  Folgende Variablen werden von _v_b_o_x_g_e_t_t_y definiert und können verwendet
  werden:

     vvbbxxvv__ssaavveettiimmee
        Anzahl Sekunden die maximal aufgezeichnet werden soll (aus
        ``_v_b_o_x_r_c'').

     vvbbxxvv__ccaalllleerriidd
        Die CallerID des aktuellen Anrufers. Wenn die Variable 0
        enthält, verfügt der Anrufer nicht über eine CallerID.

     vvbbxxvv__ccaalllleerrnnaammee
        Der Name des aktuellen Anrufers (aus ``_v_b_o_x_r_c'').

     vvbbxxvv__llooccaallpphhoonnee
        Die lokale Telefonnummer die angerufen wurde.

     vvbbxxvv__uusseerrnnaammee
        Der Name des aktuellen Benutzers (aus ``_/_e_t_c_/_p_a_s_s_w_d'').

     vvbbxxvv__uusseerrhhoommee
        Das Spoolverzeichnis des aktuellen Benutzers.

     vvbbxxvv__uusseeddssccrriipptt
        Der Name unter dem dieses Skript aufgerufen wurde.

     vvbbxxvv__ssaavveeuullaaww
        Der Name der Datei unter dem die aufgezeichnete Nachricht
        gespeichert wird.

     vvbbxxvv__ssaavveevvbbooxx
        Der Name der Datei unter dem Informationen zur aufgezeichneten
        Nachricht gespeichert werden.

  Das Skript wird unter den Rechten des jeweiligen Benutzers ausgeführt.

  66..22..  NNeeuuee KKoommmmaannddooss

  77..  vvbbooxxggeettttyy

  88..  mmkkvvbbooxxuusseerrssppooooll

  99..  TTOODDOO

  Hinweis zu: - SAFT (http://www.belwue.de/BelWue/software/saft/) - Sox
  - Rplay - NAS - isdn4linux - i4l FAQ's

  xxx


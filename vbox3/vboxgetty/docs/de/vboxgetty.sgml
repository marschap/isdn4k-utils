<!doctype linuxdoc system>

<article>

<title>vboxgetty
<author>Michael Herold, <tt><htmlurl url="mailto:michael@isdn4linux.de" name="michael@isdn4linux.de"></tt>
<date>v3.0, 6. Juli 1998
<abstract>
Die Dokumentation beschreibt die Installation und Konfiguration von
<em/vboxgetty/. <em/vboxgetty/ ist Teil des <em/vbox/ Paketes - einem
Anrufbeantworter für <em><htmlurl url="http://www.isdn4linux.de/"
name="isdn4linux"></em>.
</abstract>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                        C O P Y R I G H T                        ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->
<toc>
<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                        C O P Y R I G H T                        ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->
<sect>Copyright
<p>xxx</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                           P R E F A C E                         ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Vorwort<label id="id-preface">
<p>
Das <em/vbox/-Paket ist eine Erweiterung zu <em><htmlurl
url="http://www.isdn4linux.de" name="isdn4linux"></em> und ermöglicht
den Betrieb eines <em/isdn/-Anrufbeantworters.
</p>

<p>
Das Hauptprogramm des Paketes ist das Programm <em/vboxgetty/, das die
Anrufe entgegennimmt, die Ansagen abspielt und die Nachrichten
aufzeichnet.
</p>

<!-- #===================================================================# -->
<!-- #                       WHAT VBOXGETTY CAN DO                       # -->
<!-- #===================================================================# -->

<sect1>Was kann vboxgetty?<label id="id-preface-whatgettydo">

<p>
Was <em/vboxgetty/ kann:
<itemize>
<item>
Sprachanrufe entgegennehmen.
</item>
<item>
Ansagetexte abspielen und/oder Nachrichten aufzeichnen.
</item>
<item>
Touchtones auswerten - mit der eingebauten <em/Tcl/-Unterstützung sind
auch komplexe Voicemailboxen möglich.
</item>
</itemize>
</p>

<p>
Eben alles was ein normaler Anrufbeantworter auch kann - und noch
einiges mehr...
</p>

<!-- #===================================================================# -->
<!-- #                      WHAT VBOXGETTY CANT DO                       # -->
<!-- #===================================================================# -->

<sect1>Was kann vboxgetty nicht?<label id="id-preface-whatgettynotdo">

<p>
Was <em/vboxgetty/ nicht kann:
<itemize>
<item>
Ohne <em/isdn4linux/ betrieben werden. Das <em/vbox/-Paket ist eine
Erweiterung zu <em/isdn4linux/!
</item>
<item>
Mit einem Voice-Modem betrieben werden.
</item>
<item>
Fax- oder Datenanrufe entgegennehmen. Dazu sind immer noch eigene
Programme nötig. <em/vbox/ ist ein reiner Anrufbeantworter!
</item>
</itemize>
</p>

<!-- #===================================================================# -->
<!-- #                        WHAT VBOXGETTY NEED                        # -->
<!-- #===================================================================# -->

<sect1>Was wird zum Betrieb benötigt?<label id="id-preface-whatgettyneed">

<p>
Damit <em/vboxgetty/ richtig funktioniert, wird folgendes benötigt:
<itemize>
<item>
Eine funktionierende und von <em/Linux/ unterstützte <em/isdn/-Karte.
</item>
<item>
Die neuste Version von <em/isdn4linux/.
</item>
<item>
<em/Linux/ Kernel ab Version 2.1.103 mit eingeschaltetem
<em/isdn4linux/ und Isdn-Audio-Support.
</item>
<item>
<em/Tcl/ ab Version 8.0.
</item>
</itemize>
</p>

<p>
Vor der Installation von <em/vboxgetty/ sollte sichergestellt werden
das alle benötigten Komponenten installiert sind und auch
funktionieren!
</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                             N E W S                             ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Neuerungen<label id="id-news">

<p>
Hier eine kurze Aufstellung der Neuerungen und Änderungen seit der
Veröffentlichung von <em/vbox/ Version 2.0.0B4/5.
</p>

<p>
Bitte lesen Sie sich die folgenden Abschnitte vor der Installation
aufmerksam durch, um Unklarheiten und Fehler zu vermeiden!
</p>

<!-- #===================================================================# -->
<!-- #                            AUDIO FORMAT                           # -->
<!-- #===================================================================# -->

<sect1>Format der Audiodateien<label id="id-news-audioformat">

<p>
Als Format für die Audiodateien wird nur noch <em/ulaw/
unterstützt. Die Formate <em/alaw/, <em/adpcm-2/, <em/adpcm-3/ und
<em/adpcm-4/ sind zwar noch in <em/isdn4linux/ enthalten, finden aber
in <em/vboxgetty/ keine Verwendung mehr.
</p>

<p>
Das hat mehrere Gründe:
<itemize>
<item>Im neu unterstützten <em/Full Duplex Modus/ (siehe <ref
id="id-news-fullduplex" name="Full Duplex Modus">) ist ein wechseln
des Formates nicht möglich.
</item>
<item>
Das Format <em/ulaw/ bietet die beste Klangqualität da die Daten nicht
komprimiert werden.
</item>
<item>
Nachrichten können mit einfachen Kommandos wie ``<tt>cat name
&gt;/dev/audio</tt>'' ausgegeben werden.
</item>
<item>
Die Verwirrung beim Umwandeln der einzelnen Formate entfällt ;-)
</item>
</itemize>
</p>

<p>
Nachteilig sei hier zu erwähnen, daß dieses Format keine Komprimierung
macht, die Dateien also u.U. groß werden können.
</p>

<p>
Es besteht allerdings die Möglichkeit, diese Dateien mit externen
Programmen komprimieren zu lassen. Das Abspielen von solchen
komprimierten Dateien wird von <em/vboxgetty/ aber zur Zeit noch nicht
unterstützt, daß heißt alle Ansagetexte, die von <em/vboxgetty/
gespielt, werden müssen in unkomprimierter Form vorliegen!
</p>

<p>
Der Header der von früheren <em/vbox/ Versionen vor jede Audiodatei
gehängt wurde entfällt ab Version 3 komplett. Es werden nur noch die
Audiodaten selbst gespeichert. Alle weiteren Informationen (wie
z.B. der Name) werden in einer eigenen Datei abgelegt. Diese Dateien -
die normalerweise von <em/vboxgetty/ erzeugt und von <em/vbox/ gelesen
werden - enden mit dem Kürzel ``<tt>.vbox</tt>''.
</p>

<p>
Wenn Sie Ihre alten Ansagetexte von <em/vbox/ Version 2 beibehalten
möchten, müssen Sie diese zuerst mit dem
<em/vbox/-Konvertierungsprogramm in <em/ulaw/ umwandeln und danach den
Header entfernen lassen!
</p>

<!-- #===================================================================# -->
<!-- #                        FULL DUPLEX MODE                           # -->
<!-- #===================================================================# -->

<sect1>Full Duplex Modus<label id="id-news-fullduplex">

<p>
Ab Version 3 arbeitet <em/vboxgetty/ nur noch im sogenannten <em/Full
Duplex Modus/, der ein gleichzeitiges Abspielen und Aufzeichnen von
Nachrichten zuläßt.
</p>

<p>
In diesem Modus ist es dann zum Beispiel möglich, bereits während dem
Abspielen des Ansagetextes die Nachricht aufzeichnen zu lassen.
</p>

<!-- #===================================================================# -->
<!-- #                           TOUCHTONES                              # -->
<!-- #===================================================================# -->

<sect1>Touchtones<label id="id-news-touchtones">

<p>
Touchtones die nur aus einzelnen Zahlen bestehen müssen nicht mehr mit
``<tt/#/'' und ``<tt/*/'' eingegrenze werden.
</p>

<p>
Die Touchtones werden von den <em/tcl/-Funktionen jetzt genauso
zurückgegeben wie sie eingegeben wurden, d.h. einzelne Touchtones als
einzelne Zahlen und eine Touchtonesequenz in ``<tt/#*/'' eingefasst.
</p>

<!-- #===================================================================# -->
<!-- #                         NUMBER WATCHING                           # -->
<!-- #===================================================================# -->

<sect1>Mehrere Nummern überwachen<label id="id-news-numberwatching">

<p>
Dank des neuen <tt/AT&amp;L/-Kommandos in <em/isdn4linux/ ist es jetzt
möglich mit einem <em/vboxgetty/ mehr als eine Nummer anzugeben (mit
Wildcards).
</p>

<p>
Die Zuweisung welche Nummer für welchen lokalen Benutzer bestimmt ist
erfolgt über eine seperate Konfigurationsdatei (siehe <ref
id="id-config-vboxgetty-user" name="vboxgetty.user">). Dort kann jedem
lokalen Benutzer eine (oder mehrere) Nummer zugewiesen
werden. Eingehende Anrufe zu dieser Nummer werden dann in den
Verzeichnissen des entsprechenden Benutzers gepeichert.
</p>

<p>
Das in früheren Versionen verwendete Kommando <tt/AT&amp;E/
funktioniert auch weiterhin, es kann aber nur eine Nummer angegeben
werden!
</p>

<!-- #===================================================================# -->
<!-- #                              SUSPEND                              # -->
<!-- #===================================================================# -->

<sect1>Suspend<label id="id-news-suspend">

<p>
Bereits von <em/vboxgetty/ angenommene Anrufe können wieder zurück auf
die Leitung gelegt (Parken) und vom Telefon angenommen werden.
</p>

<p>
<bf/Bemerkung:/ Im Moment ist die Nummer zum Parken noch nicht frei
wählbar, es wird immer <tt/1/ benutzt!
</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                     I N S T A L L A T I O N                     ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Installation<label id="id-install">

<p>
Die Installation von <em/vboxgetty/ unterteilt sich in 4 Schritte:
<itemize>
<item>
Anpassung an das lokale System
</item>
<item>
Erzeugen der Programme
</item>
<item>
Installieren der Programme
</item>
<item>
Konfiguration von <em/vboxgetty/
</item>
</itemize>

<!-- #===================================================================# -->
<!-- #                            CONFIGURE                              # -->
<!-- #===================================================================# -->

<sect1>Anpassung an das lokale System<label id="id-install-configure">

<p>
Bevor irgend eines der Programme von <em/vbox/ compiliert oder
installiert werden kann, muß ``<em><file>configure</file></em>'' aus
dem Hauptverzeichnis gestartet werden. Das Skript untersucht Ihr
System, prüft ob alle benötigten Komponenten installiert sind
und erzeugt einige Dateien die zur Weiterarbeit benötigt werden.
</p>

<p>
Das Skript muß nur <bf/einmal/ zu Beginn gestartet werden! Die dort
gemachten Einstellungen gelten für <bf/alle/ Programme des
<em/vbox/-Pakets!
</p>

<p>
Über verschiedene Parameter können Sie Voreinstellungen dieses Skripts
ändern. Eine genaue Auflistung aller möglichen Parameter erhalten Sie, wenn
Sie in der Shell folgenden Befehl eingeben:

<tscreen><verb>
./configure --help
</verb></tscreen>

Hier eine Beschreibung der wichtigsten Parameter:

<descrip>

<tag/--sbindir=DIR/
<tt/DIR/ legt das Verzeichnis fest, in das <em/vboxgetty/ (und alle weiteren
Programme die nur vom Benutzer <em/root/ gestartet werden können) installiert
werden soll. Voreinstellung ist ``<tt>/usr/local/sbin</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;sbindir&gt;/
beschrieben.

<tag/--bindir=DIR/
<tt/DIR/ legt das Verzeichnis fest, in das <em/vbox/ (und alle weiteren
Programme die von jedem Benutzer gestartet werden können) installiert werden
soll. Voreinstellung ist ``<tt>/usr/local/bin</tt>''. Dieses Verzeichnis
wird in der weiteren Dokumentation mit <bf/&lt;bindir&gt;/ beschrieben.

<tag/--datadir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in das die Tcl-Skripte von <em/vboxgetty/
installiert werden sollen. Dort wird automatisch das Unterverzeichnis
``<tt/vbox/'' erzeugt. Voreinstellung ist ``<tt>/usr/local/share</tt>''.
Dieses Verzeichnis wird in der weiteren Dokumentation mit
<bf/&lt;pkgdatadir&gt;/ beschrieben.

<tag/--sysconfdir=DIR/
<tt/DIR/ legt das Verzeichnis fest, in welches die Konfigurationsdateien
installiert werden sollen. Voreinstellung ist ``<tt>/usr/local/etc</tt>''.
Dieses Verzeichnis wird in der weiteren Dokumentation mit
<bf/&lt;sysconfdir&gt;/ beschrieben.

<tag/--with-logdir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in welches die Logdateien der Programme
geschrieben werden sollen. Voreinstellung ist ``<tt>/var/log</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;logdir&gt;/
beschrieben.

<tag/--with-lockdir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in welches die Lockdateien der Programme
erzeugt werden sollen. Voreinstellung ist ``<tt>/var/lock</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;lockdir&gt;/
beschrieben.

<tag/--with-piddir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in welches die Prozeßdateien der Programme
erzeugt werden sollen. Voreinstellung ist ``<tt>/var/run</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;piddir&gt;/
beschrieben.

</descrip>
</p>

<!-- #===================================================================# -->
<!-- #                               MAKE                                # -->
<!-- #===================================================================# -->

<sect1>Erzeugen der Programme<label id="id-install-make">

<p>
Alle Programme des <em/vbox/-Pakets können mit

<tscreen><verb>
make
</verb></tscreen>

aus dem Hauptverzeichnis erzeugt werden. Um nur einzelne Programme zu
erzeugen muß ``<em><file>make</file></em>'' im jeweiligen Verzeichnis
aufgerufen werden.
</p>

<p>
Wenn Sie z.B. nur <em/vboxgetty/ erzeugen möchten, wechseln Sie in das
Verzeichnis von <em/vboxgetty/ und startet dort
``<em><file>make</file></em>''.
</p>

<!-- #===================================================================# -->
<!-- #                           MAKE INSTALL                            # -->
<!-- #===================================================================# -->

<sect1>Installieren der Programme<label id="id-install-make-install">

<p>
Alle Programme des <em/vbox/-Pakets können mit

<tscreen><verb>
make install
</verb></tscreen>

aus dem Hauptverzeichnis installiert werden. Um nur einzelne Programme
zu installieren muß ``<em><file>make install</file></em>'' im
jeweiligen Verzeichnis aufgerufen werden.
</p>

<p>
Wenn Sie z.B. nur <em/vboxgetty/ installieren möchten, wechseln Sie in
das Verzeichnis von <em/vboxgetty/ und startet dort ``<em><file>make
install</file></em>''.
</p>

<p>
Bevor die Programme installiert werden können, müssen sie mit
``<em><file>make</file></em>'' (siehe <ref id="id-install-make"
name="Erzeugen der Programme">) erzeugt werden. Ein ``<em><file>make
install</file></em>'' erzeugt <bf/nicht alle/ Programme!
</p>

<p>
Wenn eine Datei die installiert werden soll bereits existiert, wird
die alte Datei <bf/nicht/ überschrieben! Die neue Datei wird
stattdessen mit der Endung ``<tt/.new/'' installiert!
</p>

<!-- #===================================================================# -->
<!-- #                        CONFIGURE VBOXGETTY                        # -->
<!-- #===================================================================# -->

<sect1>Konfiguration von vboxgetty<label id="id-install-setup-getty">

<p>
Bevor Sie <em/vboxgetty/ zum erstenmal nutzen können, müssen erst einige
Einstellungen gemacht werden.
</p>

<p>
Es werden drei Konfigurationsdateien benutzt:
<descrip>
<tag/vboxgetty.conf/
Mit dieser Datei wird der getty selbst konfiguriert. Hier kann
u.A. eingestellt werden welches Device benutzt werden soll und wie es
initialisiert wird.
<tag/vboxgetty.user/
Mit dieser Datei wird festgelegt, welche lokale Telefonnummer welchem
Benutzer zugewiesen wird.
<tag/vboxrc/
Diese Datei enthält Einstellungen des jeweiligen Benutzers. Hier wird
festgelegt welche Anrufe wann und wie entgegengenommen werden sollen.
</descrip>
</p>

<p>
Die jeweils möglichen Einstellungen können Sie unter <ref
id="id-config" name="Konfiguration"> nachlesen.
</p>

<p>
Wie <em/vboxgetty/ selbst gestartet werden kann, lesen Sie bitte unter
<ref id="id-vboxgetty" name="vboxgetty"> nach.
</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                    K O N F I G U R A T I O N                    ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Konfiguration<label id="id-config">

<!-- #===================================================================# -->
<!-- #                           VBOXGETTY.CONF                          # -->
<!-- #===================================================================# -->

<sect1>vboxgetty.conf<label id="id-config-vboxgetty-conf">

<p>
Die Datei ``<em><file>&lt;sysconfdir&gt;/vboxgetty.conf</file></em>''
dient zur globalen Einstellung eines <em/vboxgetty/.
</p>

<p>
Die Einstellungen können wie folgt angegeben werden:
<tscreen><verb>
name = value
</verb></tscreen>
</p>

<p>
Wobei ``<bf/name/'' für die zu setzende Variable und ``<bf/value/''
für den zu setzenden Wert steht. Vor und nach dem ``<tt/=/'' kann mit
Leerzeichen oder Tabulatoren getrennt werden. Kommentare am Ende einer
Zeile sind nicht möglich!.
</p>

<p>
Leere Zeilen und solche die mit einem ``<tt/#/'' beginnen werden
überlesen. Eine Zeile darf nicht länger als 200 Zeichen werden!
</p>

<p>
Für ``<bf/name/'' können folgende Schlüsselworte verwendet werden:

<descrip>

<tag/init/
Kommando mit dem das Modem initialisiert werden soll. Voreinstellung
ist <bf/<tt/ATZ&amp;B512//.

<tag/initnumber/
Kommando mit dem die Nummern eingestellt werden sollen auf die
<em/vboxgetty/ reagieren soll. Hierzu kann der neue AT-Befehl
``<tt/AT&amp;L/'' verwendet werden. Bei diesem Befehl können mehrere
Nummern durch ``<tt/;/'' getrennt angegeben werden. Zudem sind
einfache Musterangaben wie ``<tt/*/'' und ``<tt/?/'' möglich. Der in
früheren Versionen benutzte Befehl ``<tt/AT&amp;E/'' kann ebenfalls
wieder verwendet werden. Es existiert keine Voreinstellung!

<tag/badinitsexit/
Gibt an, nach wievielen fehlerhaften Modeminitalisierungen sich
<em/vboxgetty/ beenden soll. Voreinstellung ist <bf/<tt/10// mal.

<tag/commandtimeout/
Anzahl Sekunden die maximal auf die Antwort eines Modemkommandos
gewartet werden soll. Voreinstellung ist <bf/<tt/4// Sekunden.

<tag/echotimeout/
Anzahl Sekunden die maximal auf das Echo eines Modemkommandos gewartet
werden soll. Voreinstellung ist <bf/<tt/4// Sekunden.

<tag/ringtimeout/
Anzahl der Sekunden die maximal auf einen RING gewartet werden
soll. Voreinstellung ist <bf/<tt/6// Sekunden.

<tag/alivetimeout/
Anzahl der Sekunden nach denen überprüft werden soll ob das Modem noch
antwortet. Die Überprüfung erfolgt nur, wenn innerhalb dieser Zeit
keine Aktivität vom Modem festgestellt wurde. Voreinstellung ist
<bf/<tt/1800// Sekunden.

<tag/toggledtrtime/
Anzahl der Millisekunden die die <tt/DTR/-Leitung auf Low gelegt
werden soll um das Modem aufzulegen. Voreinstellung ist <bf/<tt/400//
Millisekunden.

<tag/spooldir/
Angabe wo sich die Spoolverzeichnisse der Benutzer
befinden. Voreinstellung ist <bf><tt>/var/spool/vbox</tt></bf>.

</descrip>
</p>

<p>
Die Datei ``<em/vboxgetty.conf/'' wird von <bf/jedem/ <em/vboxgetty/
eingelesen.
</p>

<p>
Nach abarbeitung dieser Datei wird versucht
``<em/vboxgetty.conf.&lt;tty&gt;/'' zu laden (wobei <em/&lt;tty&gt;/
für den Namen des von <em/vboxgetty/ verwendeten tty's
steht). Existiert diese Datei, können damit die Einstellungen aus
``<em/vboxgetty.conf/'' überschrieben werden!
</p>

<p>
Beispiel der Datei ``<em/vboxgetty.conf/'':

<tscreen><verb>
# Global vboxgetty configuration. Please take a look at the documentation
# to learn how the configuration work!

init            AT&amp;B512
spooldir        /var/spool/vbox
</verb></tscreen>
</p>

<p>
Beispiel der Datei ``<em/vboxgetty.conf.ttyI0/'':

<tscreen><verb>
# vboxgetty configuration for ttyI0. Please take a look at the
# documentation to learn how the configuration work!

initnumber      AT&amp;L784711;784712;78471[34];78472?
</verb></tscreen>
</p>

<!-- #===================================================================# -->
<!-- #                           VBOXGETTY.USER                          # -->
<!-- #===================================================================# -->

<sect1>vboxgetty.user<label id="id-config-vboxgetty-user">

<p>
Ab Version 3 von <em/vbox/ kann ein <em/vboxgetty/ mittels des
Kommandos <tt/AT&amp;L/ mehrere Nummern überwachen (siehe auch
<ref id="id-config-vboxgetty-conf" name="vboxgetty.conf">).
</p>

<p>
Über die Datei
``<em><file>&lt;sysconfdir&gt;/vboxgetty.user</file></em>'' wird
festgelegt, welche Telefonnummer welchem lokalen Benutzer zugeordnet
ist.
</p>

<p>
Bei einem eingehenden Anruf wird die angerufene Nummer in dieser Datei
gesucht und der Anruf einem lokalen Benutzer zugeordnet. Danach werden
die Rechte des <em/vboxgetty/ auf diesen Benutzer gesetzt und alle
weiteren Operationen werden unter diesen Rechten vorgenommen.
</p>

<p>
Jede Zuordnung beginnt in einer neuen Zeile und hat folgendes Format:
<tscreen><verb>
number:user:group:umask:space
</verb></tscreen>
</p>

<p>
Kommentare (mit dem Zeichen ``<tt/#/'' am Zeilenanfang eingeleitet)
und leere Zeilen werden überlesen. Eine einzelne Zeile darf nicht
länger als 200 Zeichen werden!
</p>

<p>
<descrip>

<tag/number/
Hier wird die Telefonnummer definiert, die einem Benutzer zugeordnet
werden soll. Es können einfache Muster angegeben werden (siehe
<em/fnmatch(3)/).  Eine Angabe von ``<tt/*/'' gilt für <bf/alle/
Nummern. Das Feld <bf/muß/ angegeben werden!

<tag/user/
Lokaler Benutzer dem die Nummer zugeordnet werden soll. Der Benutzer
kann namentlich oder als UID (eingeleitet mit einem ``<tt/#/'')
angegeben werden.  Das Feld <bf/muß/ angegeben werden!

<tag/group/
Gruppe die für den Benutzer gesetzt werden soll. Die Gruppe kann
namentlich oder als GID (eingeleitet mit einem ``<tt/#/'') angegeben
werden.  Bei einem leeren Feld wird keine Gruppe gesetzt. Das Feld ist
optional und muß nicht angegeben werden.

<tag/umask/
Die Maske die zum anlegen von neuen Dateien oder Verzeichnissen
benutzt werden soll. Bei einem leeren Feld wird die Maske (umask)
nicht gesetzt. Das Feld ist optional und muß nicht angegeben werden.

<tag/space/
Freier Platz in Bytes, der auf der Partition auf der sich das
<em>&lt;spooldir&gt;</em> (siehe <ref id="id-config-vboxgetty-conf"
name="vboxgetty.conf">) des Benutzers befindet frei sein muß, damit
der Anruf angenommen wird. Bei einem leeren Feld oder ``<tt/0/'' wird
keine Überprüfung des freien Platzes gemacht. Das Feld ist optional
und muß nicht angegeben werden.

</descrip>
</p>

<p>
Ein eingehender Anruf wird <bf/nicht/ angenommen, wenn die Datei nicht
existiert oder der angerufenen Nummer kein Benutzer zugeordnet werden
konnte!
</p>

<p>
Beispiel der Datei ``<em/vboxgetty.user/'':

<tscreen><verb>
# Number to user mapping. Please read the documentation to learn how this
# configuration file work!
#
# The fields "number" and "user" *must* be set - all others are optional!
#
# Format: number:user:group:umask:freespace

784711:peter::0077:2000000
784712:willy:firma:0007:2000000
78471?:firma:firma:0007:4000000
*:#100:#500:0077:
</verb></tscreen>
</p>

<!-- #===================================================================# -->
<!-- #                               VBOXRC                              # -->
<!-- #===================================================================# -->

<sect1>vboxrc<label id="id-config-vboxrc">

<p>
Die Datei ``<em/vboxrc/'' muß für jeden Benutzer existieren (ansonsten
wird der Anruf nicht angenommen) und befindet sich im Spoolverzeichnis
des Benutzers (<em>&lt;spooldir&gt;/&lt;username&gt;</em>).
</p>

<p>
Die Datei setzt sich aus mehreren Sektionen zusammen. Eine Sektion
beginnt mit dem Zeichen ``<tt/[/'' gefolgt vom Sekionsnamen und wird
mit dem Zeichen ``<tt/]/'' abgeschlossen. Die Sektion zählt bis zum
nächsten Sektionsbeginn oder dem Ende der Datei.
</p>

<p>
Leere Zeilen oder solche die mit einem ``<tt/#/'' beginnen werden
überlesen. Eine Zeile darf nicht länger als 200 Zeichen werden!
</p>

<p>
Mit dem Kommando ``<em/<file/mkvboxuserspool//'' (siehe <ref
id="id-mkvboxuserspool" name="mkvboxuserspool">) können
Spoolverzeichnisse für einzelne Benutzer angelegt werden. Der Befehl
erzeugt zudem ein Beispiel der Datei ``<em/vboxrx/''. Die Datei wird
dabei so angelegt, das jeder Anruf nach 5x Klingeln beantwortet wird.
</p>

<p>
Hier ein Beispiel der Datei ``<em/vboxrc/'':

<tscreen><verb>
[CALLERID]

931784711      -         Michael 'Ghandi' Herold
93178471?      -         Nicole Sauvage
*              *         *** Unknown ***

[Michael 'Ghandi' Herold]
*               *       answercall.tcl    240      4       0

[Nicole Sauvage]
*               *       answercall.tcl    120      4       0

[DEFAULT]

00:00-09:59     *       answercall.tcl    120      1       0
*               *       answercall.tcl     90      6       4
</verb></tscreen>
</p>

<p>
Bevor die Datei ``<em/vboxrc/'' geladen wird, wird nach der Datei
``<em/vboxrc.&lt;localphone&gt;/'' gesucht (<em/&lt;localphone&gt;/
entspricht dabei der lokalen Telefonnummer die angerufen wurde).
</p>

<p>
Existiert diese Datei, wie sie anstelle von ``<em/vboxrc/'' benutzt!
</p>

<p>
Im weiteren werden hier die einzelnen möglichen Sektionen beschrieben.
</p>

<!-- #===================================================================# -->
<!-- #                         SECTION CALLERID                          # -->
<!-- #===================================================================# -->

<sect2>CALLERID<label id="id-config-vboxrc-callerid">

<p>
In der Sektion ``<tt/[CALLERID]/'' wird festgelegt, welche Nummer
welcher Person zugeordnet wird und welche Einstellungen benutzt werden
sollen wenn ein Anruf von dieser Person eingeht.
</p>

<p>
Einträge in dieser Sektion beginnen jeweils in einer neuen Zeile und
werden wie folgt angegeben:

<tscreen><verb>
number section name
</verb></tscreen>

Die einzelnen Angaben müssen mit Leerzeichen oder Tabulator
voneinander getrennt werden. Die Felder ``<em/number/'' und
``<em/section/'' dürfen selbst keine Leerzeichen oder Tabulatoren
enthalten!
</p>

<p>
<descrip>

<tag/number/
Nummer der jeweiligen Person. Es können einfache Muster angegeben
werden (siehe <em/fnmatch(3)/). Die Nummer muß jeweils so angegeben
werden wie sie von <em/isdn4linux/ übermittelt wird.

<tag/section/
Name der Benutzersektion die bei einem Anruf dieser Person verwendet
werden soll. Wird hier ein ``<tt/*/'' angegeben, wird die Sektion
``<tt/[DEFAULT]/'' benutzt; bei einem ``<tt/-/'' wird ``<em/name/''
als Name der Benutzersektion verwendet. Alle anderen Angaben werden
als Name der Benutzersektion gewertet.

<tag/name/
Name der jeweiligen Person. Dieser Name wird z.B. in die von
<em/vboxgetty/ erzeugten ``.vbox'' Dateien geschrieben.

</descrip>
</p>

<!-- #===================================================================# -->
<!-- #                           USER SECTIONS                           # -->
<!-- #===================================================================# -->

<sect2>Benutzersektionen<label id="id-config-vboxrc-user">

<p>
Benutzersektionen werden auf die gleiche Art definiert wie die fest
von <em/vboxgetty/ benutzen Sektionen. Sie beginnen mit einem
``<tt/[/'' gefolgt von einem frei wählbaren Namen und werden mit einem
``<tt/]/'' abgeschlossen.
</p>

<p>
Einträge in dieser Sektion beginnen jeweils in einer neuen Zeile und
werden wie folgt angegeben:

<tscreen><verb>
time day scriptname savetime ringring tollring
</verb></tscreen>

Die einzelnen Angaben müssen mit Leerzeichen oder Tabulator
voneinander getrennt werden.
</p>

<p>
<descrip>

<tag/time/
Zeiten zu denen diese Einstellungen benutzt werden sollen. Das genaue
Format einer Zeitangabe kann unter <ref id="id-config-time"
name="Zeitangaben"> nachgelesen werden.

<tag/day/
Tage an denen diese Einstellungen benutzt werden sollen. Das genaue
Format einer Tagesangabe kann unter <ref id="id-config-days"
name="Tagesangaben"> nachgelesen werden.

<tag/scriptname/
Name des <em/Tcl/-Skriptes das zum beantworten dieses Anrufes benutzt
werden soll. Pfadangaben im Skriptnamen werden automatisch
entfernt. Das Skript wird zuerst im Verzeichnis
``<em>&lt;spooldir&gt;/&lt;username&gt;/tscripts</em>'' und danach in
``<em>&lt;pkgdatadir&gt;</em>'' gesucht (siehe auch <ref
id="id-tcl-script-answercall" name="answercall.tcl">).

<tag/savetime/
Maximale Aufzeichnungszeit in Sekunden. Die Angabe wird dem Skript
``<em/scriptname/'' als Variable übergeben und kann dort benutzt
werden.

<tag/ringring/
Anzahl der Klingelzeichen nach denen der Anruf beantwortet werden
soll. Wird hier <bf/<tt/0// angegeben, wird der Anruf ignoriert.

<tag/tollring/
Anzahl der Klingelzeichen nach denen der Anruf beantwortet werden
soll, wenn im Spoolverzeichnis des jeweiligen Benutzers noch neue
Nachrichten liegen. Wenn hier <bf/<tt/0// angegeben wird, wird nicht
geprüft ob neue Nachrichten vorhanden sind; es gelten dann die Angaben
von ``<em/ringring/''.

</descrip>
</p>

<!-- #===================================================================# -->
<!-- #                            TIME FORMAT                            # -->
<!-- #===================================================================# -->

<sect1>Zeitangaben<label id="id-config-time">

<p>
Einzelne Zeitangaben werden durch Kommata getrennt, Angaben von Start-
und Endzeit durch ein Minuszeichen. Die Stundenangaben müssen im
24-Stunden-Format - also von 0 Uhr bis 23 Uhr - gemacht werden.
</p>

<p>
Die Zeitangaben werden intern immer in Start- und Endzeit umgerechnet,
auch dann, wenn nur eine Startzeit angegeben ist.
</p>

<p>
Nehmen wir zum Beispiel folgende Zeitangaben:

<verb>
20:15-21:14
</verb>
</p>

<p>
Diese Zeit wird intern in 20:15:00-21:14:59 umgerechnet, d.h. Start-
und Endzeit sind <bf/inklusive/!
</p>

<p>
Wenn bei einer Zeitangabe keine Minuten angebenen sind, wird bei der
Startzeit 0 Minuten und bei der Endzeit 59 Minuten benutzt. Intern
werden die Sekunden - die nicht einstellbar sind - nach dem gleichen
Schema behandelt.
</p>

<p>
<descrip>
<tag>Beispiel:</tag>
<itemize>
<item><tt>20          -</tt> Umrechnung nach 20:00:00-20:59:59</item>
<item><tt>20:15-21:14 -</tt> Umrechnung nach 20:15:00-21:14:59</item>
<item><tt>08-11       -</tt> Umrechnung nach 08:00:00-11:59:59</item>
<item><tt>12-15:30    -</tt> Umrechnung nach 12:00:00-15:30:59</item>
</itemize>
</descrip>
</p>

<p>
Eine Zeitzone zählt als zutreffend (match) wenn die aktuelle Zeit
größer/gleich der Startzeit <bf>und</bf> kleiner/gleich der Endzeit ist.
</p>

<p>
Ein ``<tt>*</tt>'' als <bf>einzige</bf> Zeitangabe wird als
<bf>immer</bf> behandelt, ein ``<tt>-</tt>'' als <bf>einzige</bf>
Zeitangabe als <bf>nie</bf>.
</p>

<!-- #===================================================================# -->
<!-- #                             DAY FORMAT                            # -->
<!-- #===================================================================# -->

<sect1>Tagesangaben<label id="id-config-days">

<p>
Einzelne Tagesangaben werden durch Kommanta getrennt. Eine Angabe von
Start- und Ende ist hier nicht möglich.
</p>

<p>
Folgende Tageskürzel können angegeben werden:

<itemize>
<item><tt>MO, MON</tt> - für Montag    </item>
<item><tt>DI, TUE</tt> - für Dienstag  </item>
<item><tt>MI, WED</tt> - für Mittwoch  </item>
<item><tt>DO, THU</tt> - für Donnerstag</item>
<item><tt>FR, FRI</tt> - für Freitag   </item>
<item><tt>SA, SAT</tt> - für Samstag   </item>
<item><tt>SO, SUN</tt> - für Sonntag   </item>
</itemize>
</p>

<p>
Eine Angabe von ``<tt/*/'' als <bf/einzige/ Tagesangabe heißt
<bf/immer/, ein ``<tt/-/'' als <bf/einzige/ Tagesangabe <bf/nie/.
</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                    K O N F I G U R A T I O N                    ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Tcl<label id="id-tcl">

<!-- #===================================================================# -->
<!-- #                              SCRIPTS                              # -->
<!-- #===================================================================# -->

<sect1>Skripte

<p>
Seit Version 2 unterstützt <em/vboxgetty/ die Verwendung von
<em/Tcl/-Skripten, die während der Laufzeit ausgeführt werden können.
</p>

<p>
Die Standard-Skripte von <em/vboxgetty/ befinden sich im Verzeichnis
``<em/&lt;pkgdatadir&gt;/''.
</p>

<!-- #===================================================================# -->
<!-- #                           INITMODEM.TCL                           # -->
<!-- #===================================================================# -->

<sect2>initmodem.tcl<label id="id-tcl-script-initmodem">

<p>
Das Skript ``<em/initmodem.tcl/'' wird jedesmal gestartet, wenn das
Modem initialisiert werden soll.
</p>

<p>
Liefert die Ausführung des Skripts einen Fehler zurück, gilt die
Initialisierung als Fehlgeschlagen.
</p>

<p>
Das Skript wird nur in ``<em/&lt;pkgdatadir&gt;/'' gesucht.
</p>

<p>
Folgende Variablen werden von <em/vboxgetty/ definiert und können
verwendet werden:

<descrip>

<tag/vbxv_init/
Das in ``<em/vboxgetty.conf/'' eingestellte Initkommando
``<em/init/''.

<tag/vbxv_initnumber/
Das in ``<em/vboxgetty.conf/'' eingestellte Initkommando
``<em/initnumber/''.

</descrip>
</p>

<p>
<bf/Achtung:/ Das Skript wird unter <bf/root/-Rechten ausgeführt und
sollte daher nicht von normalen Benutzern änderbar sein!
</p>

<!-- #===================================================================# -->
<!-- #                           ANSWERCALL.TCL                          # -->
<!-- #===================================================================# -->

<sect2>answercall.tcl<label id="id-tcl-script-answercall">

<p>
Das Skript ``<em/answercall.tcl/'' (der Name kann sich je nach
``<em/vboxrc/'' ändern) wird aufgerufen, nachdem der eingegangene
Anruf beantwortet wurde.
</p>

<p>
Das Skript wird zuerst im Verzeichnis
``<em>&lt;spooldir&gt;/&lt;username&gt;/tscripts</em>'' und danach in
``<em>&lt;pkgdatadir&gt;</em>'' gesucht.
</p>

<p>
In diesem Skript werden die Ansagetexte abgespielt, Nachrichten
aufgezeichnet und die Touchtones ausgewertet.
</p>

<p>
Folgende Variablen werden von <em/vboxgetty/ definiert und können
verwendet werden:

<descrip>

<tag/vbxv_savetime/
Anzahl Sekunden die maximal aufgezeichnet werden soll (aus
``<em/vboxrc/'').

<tag/vbxv_callerid/
Die <tt/CallerID/ des aktuellen Anrufers. Wenn die Variable
<bf/<tt/0// enthält, verfügt der Anrufer nicht über eine CallerID.

<tag/vbxv_callername/
Der Name des aktuellen Anrufers (aus ``<em/vboxrc/'').

<tag/vbxv_localphone/
Die lokale Telefonnummer die angerufen wurde.

<tag/vbxv_username/
Der Name des aktuellen Benutzers (aus ``<em>/etc/passwd</em>'').

<tag/vbxv_userhome/
Das Spoolverzeichnis des aktuellen Benutzers.

<tag/vbxv_usedscript/
Der Name unter dem dieses Skript aufgerufen wurde.

<tag/vbxv_saveulaw/
Der Name der Datei unter dem die aufgezeichnete Nachricht gespeichert
wird.

<tag/vbxv_savevbox/
Der Name der Datei unter dem Informationen zur aufgezeichneten
Nachricht gespeichert werden.

</descrip>
</p>

<p>
Das Skript wird unter den Rechten des jeweiligen Benutzers ausgeführt.
</p>

<!-- #===================================================================# -->
<!-- #                             DAY FORMAT                            # -->
<!-- #===================================================================# -->

<!-- #===================================================================# -->
<!-- #                             DAY FORMAT                            # -->
<!-- #===================================================================# -->

<sect1>Neue Kommandos




<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                    K O N F I G U R A T I O N                    ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->




<sect>vboxgetty<label id="id-vboxgetty">

<p>
</p>

<sect>mkvboxuserspool<label id="id-mkvboxuserspool">

<p>
</p>

<sect>TODO

<p>

Hinweis zu:
- SAFT (http://www.belwue.de/BelWue/software/saft/)
- Sox
- Rplay
- NAS
- isdn4linux
- i4l FAQ's




</p>










<p>xxx</p>












</article>

<!doctype linuxdoc system>

<article>

<title>vboxgetty
<author>Michael Herold, <tt><htmlurl url="mailto:michael@isdn4linux.de" name="michael@isdn4linux.de"></tt>
<date>v3.0, 6. Juli 1998
<abstract>
Die Dokumentation beschreibt die Installation und Konfiguration von
<em/vboxgetty/. <em/vboxgetty/ ist Teil des <em/vbox/ Paketes - einem
Anrufbeantworter für <em><htmlurl url="http://www.isdn4linux.de/"
name="isdn4linux"></em>.
</abstract>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                        C O P Y R I G H T                        ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->
<toc>
<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                        C O P Y R I G H T                        ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->
<sect>Copyright
<p>xxx</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                           P R E F A C E                         ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Vorwort<label id="id-preface">
<p>
Das <em/vbox/-Paket ist eine Erweiterung zu <em><htmlurl
url="http://www.isdn4linux.de" name="isdn4linux"></em> und ermöglicht
den Betrieb eines <em/isdn/-Anrufbeantworters.
</p>

<p>
Das Hauptprogramm des Paketes ist das Programm <em/vboxgetty/, das die
Anrufe entgegennimmt, die Ansagen abspielt und die Nachrichten
aufzeichnet.
</p>

<!-- #===================================================================# -->
<!-- #                       WHAT VBOXGETTY CAN DO                       # -->
<!-- #===================================================================# -->

<sect1>Was kann vboxgetty?<label id="id-preface-whatgettydo">

<p>
Was <em/vboxgetty/ kann:
<itemize>
<item>
Sprachanrufe entgegennehmen.
</item>
<item>
Ansagetexte abspielen und/oder Nachrichten aufzeichnen.
</item>
<item>
Touchtones auswerten - mit der eingebauten <em/Tcl/-Unterstützung sind
auch komplexe Voicemailboxen möglich.
</item>
</itemize>
</p>

<p>
Eben alles was ein normaler Anrufbeantworter auch kann - und noch
einiges mehr...
</p>

<!-- #===================================================================# -->
<!-- #                      WHAT VBOXGETTY CANT DO                       # -->
<!-- #===================================================================# -->

<sect1>Was kann vboxgetty nicht?<label id="id-preface-whatgettynotdo">

<p>
Was <em/vboxgetty/ nicht kann:
<itemize>
<item>
Ohne <em/isdn4linux/ betrieben werden. Das <em/vbox/-Paket ist eine
Erweiterung zu <em/isdn4linux/!
</item>
<item>
Mit einem Voice-Modem betrieben werden.
</item>
<item>
Fax- oder Datenanrufe entgegennehmen. Dazu sind immer noch eigene
Programme nötig. <em/vbox/ ist ein reiner Anrufbeantworter!
</item>
</itemize>
</p>

<!-- #===================================================================# -->
<!-- #                        WHAT VBOXGETTY NEED                        # -->
<!-- #===================================================================# -->

<sect1>Was wird zum Betrieb benötigt?<label id="id-preface-whatgettyneed">

<p>
Damit <em/vboxgetty/ richtig funktioniert, wird folgendes benötigt:
<itemize>
<item>
Eine funktionierende und von <em/Linux/ unterstützte <em/isdn/-Karte.
</item>
<item>
Die neuste Version von <em/isdn4linux/.
</item>
<item>
<em/Linux/ Kernel ab Version 2.1.103 mit eingeschaltetem
<em/isdn4linux/ und Isdn-Audio-Support.
</item>
<item>
<em/Tcl/ ab Version 8.0.
</item>
</itemize>
</p>

<p>
Vor der Installation von <em/vboxgetty/ sollte sichergestellt werden
das alle benötigten Komponenten installiert sind und auch
funktionieren!
</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                             N E W S                             ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Neuerungen<label id="id-news">

<p>
Hier eine kurze Aufstellung der Neuerungen und Änderungen seit der
Veröffentlichung von <em/vbox/ Version 2.0.0B4/5.
</p>

<p>
Bitte lesen Sie sich die folgenden Abschnitte vor der Installation
aufmerksam durch, um Unklarheiten und Fehler zu vermeiden!
</p>

<!-- #===================================================================# -->
<!-- #                            AUDIO FORMAT                           # -->
<!-- #===================================================================# -->

<sect1>Format der Audiodateien<label id="id-news-audioformat">

<p>
Als Format für die Audiodateien wird nur noch <em/ulaw/
unterstützt. Die Formate <em/alaw/, <em/adpcm-2/, <em/adpcm-3/ und
<em/adpcm-4/ sind zwar noch in <em/isdn4linux/ enthalten, finden aber
in <em/vboxgetty/ keine Verwendung mehr.
</p>

<p>
Das hat mehrere Gründe:
<itemize>
<item>Im neu unterstützten <em/Full Duplex Modus/ (siehe <ref
id="id-news-fullduplex" name="Full Duplex Modus">) ist ein wechseln
des Formates nicht möglich.
</item>
<item>
Das Format <em/ulaw/ bietet die beste Klangqualität da die Daten nicht
komprimiert werden.
</item>
<item>
Nachrichten können mit einfachen Kommandos wie ``<tt>cat name
&gt;/dev/audio</tt>'' ausgegeben werden.
</item>
<item>
Die Verwirrung beim Umwandeln der einzelnen Formate entfällt ;-)
</item>
</itemize>
</p>

<p>
Nachteilig sei hier zu erwähnen, daß dieses Format keine Komprimierung
macht, die Dateien also u.U. groß werden können.
</p>

<p>
Es besteht allerdings die Möglichkeit, diese Dateien mit externen
Programmen komprimieren zu lassen. Das Abspielen von solchen
komprimierten Dateien wird von <em/vboxgetty/ aber zur Zeit noch nicht
unterstützt, daß heißt alle Ansagetexte, die von <em/vboxgetty/
gespielt, werden müssen in unkomprimierter Form vorliegen!
</p>

<p>
Der Header der von früheren <em/vbox/ Versionen vor jede Audiodatei
gehängt wurde entfällt ab Version 3 komplett. Es werden nur noch die
Audiodaten selbst gespeichert. Alle weiteren Informationen (wie
z.B. der Name) werden in einer eigenen Datei abgelegt. Diese Dateien -
die normalerweise von <em/vboxgetty/ erzeugt und von <em/vbox/ gelesen
werden - enden mit dem Kürzel ``<tt>.vbox</tt>''.
</p>

<p>
Wenn Sie Ihre alten Ansagetexte von <em/vbox/ Version 2 beibehalten
möchten, müssen Sie diese zuerst mit dem
<em/vbox/-Konvertierungsprogramm in <em/ulaw/ umwandeln und danach den
Header entfernen lassen!
</p>

<!-- #===================================================================# -->
<!-- #                        FULL DUPLEX MODE                           # -->
<!-- #===================================================================# -->

<sect1>Full Duplex Modus<label id="id-news-fullduplex">

<p>
Ab Version 3 arbeitet <em/vboxgetty/ nur noch im sogenannten <em/Full
Duplex Modus/, der ein gleichzeitiges Abspielen und Aufzeichnen von
Nachrichten zuläßt.
</p>

<p>
In diesem Modus ist es dann zum Beispiel möglich, bereits während dem
Abspielen des Ansagetextes die Nachricht aufzeichnen zu lassen.
</p>

<!-- #===================================================================# -->
<!-- #                           TOUCHTONES                              # -->
<!-- #===================================================================# -->

<sect1>Touchtones<label id="id-news-touchtones">

<p>
Touchtones die nur aus einzelnen Zahlen bestehen müssen nicht mehr mit
``<tt/#/'' und ``<tt/*/'' eingegrenze werden.
</p>

<p>
Die Touchtones werden von den <em/tcl/-Funktionen jetzt genauso
zurückgegeben wie sie eingegeben wurden, d.h. einzelne Touchtones als
einzelne Zahlen und eine Touchtonesequenz in ``<tt/#*/'' eingefasst.
</p>

<!-- #===================================================================# -->
<!-- #                         NUMBER WATCHING                           # -->
<!-- #===================================================================# -->

<sect1>Mehrere Nummern überwachen<label id="id-news-numberwatching">

<p>
Dank des neuen <tt/AT&amp;L/-Kommandos in <em/isdn4linux/ ist es jetzt
möglich mit einem <em/vboxgetty/ mehr als eine Nummer anzugeben (mit
Wildcards).
</p>

<p>
Die Zuweisung welche Nummer für welchen lokalen Benutzer bestimmt ist
erfolgt über eine seperate Konfigurationsdatei (siehe <ref
id="id-config-vboxgetty-user" name="vboxgetty.user">). Dort kann jedem
lokalen Benutzer eine (oder mehrere) Nummer zugewiesen
werden. Eingehende Anrufe zu dieser Nummer werden dann in den
Verzeichnissen des entsprechenden Benutzers gepeichert.
</p>

<p>
Das in früheren Versionen verwendete Kommando <tt/AT&amp;E/
funktioniert auch weiterhin, es kann aber nur eine Nummer angegeben
werden!
</p>

<!-- #===================================================================# -->
<!-- #                              SUSPEND                              # -->
<!-- #===================================================================# -->

<sect1>Suspend<label id="id-news-suspend">

<p>
Bereits von <em/vboxgetty/ angenommene Anrufe können wieder zurück auf
die Leitung gelegt (Parken) und vom Telefon angenommen werden.
</p>

<p>
<bf/Bemerkung:/ Im Moment ist die Nummer zum Parken noch nicht frei
wählbar, es wird immer <tt/1/ benutzt!
</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                     I N S T A L L A T I O N                     ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Installation<label id="id-install">

<p>
Die Installation von <em/vboxgetty/ unterteilt sich in 4 Schritte:
<itemize>
<item>
Anpassung an das lokale System
</item>
<item>
Erzeugen der Programme
</item>
<item>
Installieren der Programme
</item>
<item>
Konfiguration von <em/vboxgetty/
</item>
</itemize>

<!-- #===================================================================# -->
<!-- #                            CONFIGURE                              # -->
<!-- #===================================================================# -->

<sect1>Anpassung an das lokale System<label id="id-install-configure">

<p>
Bevor irgend eines der Programme von <em/vbox/ compiliert oder
installiert werden kann, muß ``<em><file>configure</file></em>'' aus
dem Hauptverzeichnis gestartet werden. Das Skript untersucht Ihr
System, prüft ob alle benötigten Komponenten installiert sind
und erzeugt einige Dateien die zur Weiterarbeit benötigt werden.
</p>

<p>
Das Skript muß nur <bf/einmal/ zu Beginn gestartet werden! Die dort
gemachten Einstellungen gelten für <bf/alle/ Programme des
<em/vbox/-Pakets!
</p>

<p>
Über verschiedene Parameter können Sie Voreinstellungen dieses Skripts
ändern. Eine genaue Auflistung aller möglichen Parameter erhalten Sie, wenn
Sie in der Shell folgenden Befehl eingeben:

<tscreen><verb>
./configure --help
</verb></tscreen>

Hier eine Beschreibung der wichtigsten Parameter:

<descrip>

<tag/--sbindir=DIR/
<tt/DIR/ legt das Verzeichnis fest, in das <em/vboxgetty/ (und alle weiteren
Programme die nur vom Benutzer <em/root/ gestartet werden können) installiert
werden soll. Voreinstellung ist ``<tt>/usr/local/sbin</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;sbindir&gt;/
beschrieben.

<tag/--bindir=DIR/
<tt/DIR/ legt das Verzeichnis fest, in das <em/vbox/ (und alle weiteren
Programme die von jedem Benutzer gestartet werden können) installiert werden
soll. Voreinstellung ist ``<tt>/usr/local/bin</tt>''. Dieses Verzeichnis
wird in der weiteren Dokumentation mit <bf/&lt;bindir&gt;/ beschrieben.

<tag/--datadir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in das die Tcl-Skripte von <em/vboxgetty/
installiert werden sollen. Dort wird automatisch das Unterverzeichnis
``<tt/vbox/'' erzeugt. Voreinstellung ist ``<tt>/usr/local/share</tt>''.
Dieses Verzeichnis wird in der weiteren Dokumentation mit
<bf/&lt;pkgdatadir&gt;/ beschrieben.

<tag/--sysconfdir=DIR/
<tt/DIR/ legt das Verzeichnis fest, in welches die Konfigurationsdateien
installiert werden sollen. Voreinstellung ist ``<tt>/usr/local/etc</tt>''.
Dieses Verzeichnis wird in der weiteren Dokumentation mit
<bf/&lt;sysconfdir&gt;/ beschrieben.

<tag/--with-logdir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in welches die Logdateien der Programme
geschrieben werden sollen. Voreinstellung ist ``<tt>/var/log</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;logdir&gt;/
beschrieben.

<tag/--with-lockdir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in welches die Lockdateien der Programme
erzeugt werden sollen. Voreinstellung ist ``<tt>/var/lock</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;lockdir&gt;/
beschrieben.

<tag/--with-piddir=DIR/
<tt/DIR/ gibt das Verzeichnis an, in welches die Prozeßdateien der Programme
erzeugt werden sollen. Voreinstellung ist ``<tt>/var/run</tt>''. Dieses
Verzeichnis wird in der weiteren Dokumentation mit <bf/&lt;piddir&gt;/
beschrieben.

</descrip>
</p>

<!-- #===================================================================# -->
<!-- #                               MAKE                                # -->
<!-- #===================================================================# -->

<sect1>Erzeugen der Programme<label id="id-install-make">

<p>
Alle Programme des <em/vbox/-Pakets können mit

<tscreen><verb>
make
</verb></tscreen>

aus dem Hauptverzeichnis erzeugt werden. Um nur einzelne Programme zu
erzeugen muß ``<em><file>make</file></em>'' im jeweiligen Verzeichnis
aufgerufen werden.
</p>

<p>
Wenn Sie z.B. nur <em/vboxgetty/ erzeugen möchten, wechseln Sie in das
Verzeichnis von <em/vboxgetty/ und startet dort
``<em><file>make</file></em>''.
</p>

<!-- #===================================================================# -->
<!-- #                           MAKE INSTALL                            # -->
<!-- #===================================================================# -->

<sect1>Installieren der Programme<label id="id-install-make-install">

<p>
Alle Programme des <em/vbox/-Pakets können mit

<tscreen><verb>
make install
</verb></tscreen>

aus dem Hauptverzeichnis installiert werden. Um nur einzelne Programme
zu installieren muß ``<em><file>make install</file></em>'' im
jeweiligen Verzeichnis aufgerufen werden.
</p>

<p>
Wenn Sie z.B. nur <em/vboxgetty/ installieren möchten, wechseln Sie in
das Verzeichnis von <em/vboxgetty/ und startet dort ``<em><file>make
install</file></em>''.
</p>

<p>
Bevor die Programme installiert werden können, müssen sie mit
``<em><file>make</file></em>'' (siehe <ref id="id-install-make"
name="Erzeugen der Programme">) erzeugt werden. Ein ``<em><file>make
install</file></em>'' erzeugt <bf/nicht alle/ Programme!
</p>

<p>
Wenn eine Datei die installiert werden soll bereits existiert, wird
die alte Datei <bf/nicht/ überschrieben! Die neue Datei wird
stattdessen mit der Endung ``<tt/.new/'' installiert!
</p>

<!-- #===================================================================# -->
<!-- #                        CONFIGURE VBOXGETTY                        # -->
<!-- #===================================================================# -->

<sect1>Konfiguration von vboxgetty<label id="id-install-setup-getty">

<p>
Bevor Sie <em/vboxgetty/ zum erstenmal nutzen können, müssen erst einige
Einstellungen gemacht werden.
</p>

<p>
Es werden drei Konfigurationsdateien benutzt:
<descrip>
<tag/vboxgetty.conf/
Mit dieser Datei wird der getty selbst konfiguriert. Hier kann
u.A. eingestellt werden welches Device benutzt werden soll und wie es
initialisiert wird.
<tag/vboxgetty.user/
Mit dieser Datei wird festgelegt, welche lokale Telefonnummer welchem
Benutzer zugewiesen wird.
<tag/vboxrc/
Diese Datei enthält Einstellungen des jeweiligen Benutzers. Hier wird
festgelegt welche Anrufe wann und wie entgegengenommen werden sollen.
</descrip>
</p>

<p>
Die jeweils möglichen Einstellungen können Sie unter <ref
id="id-config" name="Konfiguration"> nachlesen.
</p>

<p>
Wie <em/vboxgetty/ selbst gestartet werden kann, lesen Sie bitte unter
<ref id="id-vboxgetty" name="vboxgetty"> nach.
</p>

<!-- ********************************************************************* -->
<!-- **                                                                 ** -->
<!-- **                    K O N F I G U R A T I O N                    ** -->
<!-- **                                                                 ** -->
<!-- ********************************************************************* -->

<sect>Konfiguration<label id="id-config">

<!-- #===================================================================# -->
<!-- #                           VBOXGETTY.CONF                          # -->
<!-- #===================================================================# -->

<sect1>vboxgetty.conf<label id="id-config-vboxgetty-conf">

<p>
</p>

<!-- #===================================================================# -->
<!-- #                           VBOXGETTY.USER                          # -->
<!-- #===================================================================# -->

<sect1>vboxgetty.user<label id="id-config-vboxgetty-user">

<p>
Ab Version 3 von <em/vbox/ kann ein <em/vboxgetty/ mittels des
Kommandos <tt/AT&amp;L/ mehrere Nummern überwachen (siehe auch
<ref id="id-config-vboxgetty-conf" name="vboxgetty.conf">).
</p>

<p>
Über die Datei
``<em><file>&lt;sysconfdir&gt;/vboxgetty.user</file></em>'' wird
festgelegt, welche Telefonnummer welchem lokalen Benutzer zugeordnet
ist.
</p>

<p>
Bei einem eingehenden Anruf wird die angerufene Nummer in dieser Datei
gesucht und der Anruf einem lokalen Benutzer zugeordnet. Danach werden
die Rechte des <em/vboxgetty/ auf diesen Benutzer gesetzt und alle
weiteren Operationen werden unter diesen Rechten vorgenommen.
</p>

<p>
Jede Zuordnung beginnt in einer neuen Zeile und hat folgendes Format:
<tscreen><verb>
number:user:group:umask:space
</verb></tscreen>
</p>

<p>
Kommentare (mit dem Zeichen ``<tt/#/'' am Zeilenanfang eingeleitet)
und leere Zeilen werden überlesen. Eine einzelne Zeile darf nicht
länger als 200 Zeichen werden!
</p>

<p>
<descrip>

<tag/number/
Hier wird die Telefonnummer definiert, die einem Benutzer zugeordnet
werden soll. Es können einfache Muster angegeben werden (siehe
<em/fnmatch(3)/).  Eine Angabe von ``<tt/*/'' gilt für <bf/alle/
Nummern. Das Feld <bf/muß/ angegeben werden!

<tag/user/
Lokaler Benutzer dem die Nummer zugeordnet werden soll. Der Benutzer
kann namentlich oder als UID (eingeleitet mit einem ``<tt/#/'')
angegeben werden.  Das Feld <bf/muß/ angegeben werden!

<tag/group/
Gruppe die für den Benutzer gesetzt werden soll. Die Gruppe kann
namentlich oder als GID (eingeleitet mit einem ``<tt/#/'') angegeben
werden.  Bei einem leeren Feld wird keine Gruppe gesetzt. Das Feld ist
optional und muß nicht angegeben werden.

<tag/umask/
Die Maske die zum anlegen von neuen Dateien oder Verzeichnissen
benutzt werden soll. Bei einem leeren Feld wird die Maske (umask)
nicht gesetzt. Das Feld ist optional und muß nicht angegeben werden.

<tag/space/
Freier Platz in Bytes, der auf der Partition auf der sich das
<em>&lt;spooldir&gt;</em> (siehe <ref id="id-config-vboxgetty-conf"
name="vboxgetty.conf">) des Benutzers befindet frei sein muß, damit
der Anruf angenommen wird. Bei einem leeren Feld oder ``<tt/0/'' wird
keine Überprüfung des freien Platzes gemacht. Das Feld ist optional
und muß nicht angegeben werden.

</descrip>
</p>

<p>
Ein eingehender Anruf wird <bf/nicht/ angenommen, wenn die Datei nicht
existiert oder der angerufenen Nummer kein Benutzer zugeordnet werden
konnte!
</p>

<p>
<bf/Beispiel der Datei ``<em/vboxgetty.user/'':/

<tscreen><verb>
# Number to user mapping. Please read the documentation to learn how this
# configuration file work!
#
# The fields "number" and "user" *must* be set - all others are optional!
#
# Format: number:user:group:umask:freespace

784711:peter::0077:2000000
784712:willy:firma:0007:2000000
78471?:firma:firma:0007:4000000
*:#100:#500:0077:
</verb></tscreen>
</p>







<sect>vboxgetty<label id="id-vboxgetty">

<p>xxx</p>












</article>

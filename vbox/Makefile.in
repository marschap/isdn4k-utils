#
# $Id: Makefile.in,v 1.11 1997/04/04 09:31:50 michael Exp $

#----------------------------------------------------------------------------#
# Things you can change to personalize the Makefile for your own site. Some  #
# values (eg the directory pathes) are used in some other files too, so do   #
# not change the values by hand - use the options to the configure-script    #
# insteed. Options you can change without configure are marked with [*].     #
#                                                                            #
# Changes to Makefile will get lost if you re-run the configuration script!  #
#----------------------------------------------------------------------------#

#----------------------------------------------------------------------------#
# [*] Program to install binaries to the sbin directory (eg vboxgetty):      #
#----------------------------------------------------------------------------#

INSTALL_SBIN	= @INSTALL@ -m 750 -o root -g root -s

#----------------------------------------------------------------------------#
# [*] Program to install binaries to the bin directory (eg vboxconvert):     #
#----------------------------------------------------------------------------#

INSTALL_BIN	= @INSTALL@ -m 755 -o root -g root -s

#----------------------------------------------------------------------------#
# [*] Program to install bash scripts to the bin directory (eg vboxplay):    #
#----------------------------------------------------------------------------#

INSTALL_SHBIN	= @INSTALL@ -m 755 -o root -g root

#----------------------------------------------------------------------------#
# [*] Program to install binaries to the bin directory and set the suid bit  #
#     (eg vboxbeep):                                                         #
#----------------------------------------------------------------------------#

INSTALL_UBIN	= @INSTALL@ -m 4755 -o root -g root -s

#----------------------------------------------------------------------------#
# [*] Program to install configurations to sysconf directory                 #
#     (eg vboxgetty.conf):                                                   #
#----------------------------------------------------------------------------#

INSTALL_SYSCONF	= @INSTALL@ -m 644 -o root -g root

#----------------------------------------------------------------------------#
# [*] Program to install locales to the locale directory:                    #
#----------------------------------------------------------------------------#

INSTALL_LOCALE	= @INSTALL@ -m 644 -o root -g root

#----------------------------------------------------------------------------#
# [*] Program to create missing directories:                                 #
#----------------------------------------------------------------------------#

INSTALL_DIRS	= @INSTALL@ -d

#----------------------------------------------------------------------------#
# [*] Message catalogs to create. The catalogs must be seperated with space  #
#     (eg: de en fr):                                                        #
#                                                                            #
#     Available catalogs are: de                                             #
#----------------------------------------------------------------------------#

CATALOGS	= @CATALOGS_TO_INSTALL@

#----------------------------------------------------------------------------#
# [*] Compiler to use and flags for the compiler & linker:                   #
#----------------------------------------------------------------------------#

CC		= @CC@
CFLAGS		= @CFLAGS@
LDFLAGS		= @LDFLAGS@

#----------------------------------------------------------------------------#
# [*] Some needed programs:                                                  #
#----------------------------------------------------------------------------#

LN		= @LN_S@
ECHO		= @VBOX_ECHO@
MV		= @VBOX_MV@
RM		= @VBOX_RM@
SED		= @VBOX_SED@
MAILCMD		= @VBOX_MAIL@
AR		= @VBOX_AR@
RANLIB		= @VBOX_RANLIB@

@SET_MAKE@

#----------------------------------------------------------------------------#
# The information below is modified by the configure script when Makefile is #
# generated from Makefile.in. Some of this values are stored in other files  #
# too, so don't change it by hand!                                           #
#----------------------------------------------------------------------------#

prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir		= @bindir@
sbindir		= @sbindir@
sysconfdir	= @sysconfdir@

LOGFILEDIR	= @VBOX_LOGDIR@
PIDFILEDIR	= @VBOX_PIDDIR@
LCKFILEDIR	= @VBOX_LCKDIR@
SPOOLDIR	= @VBOX_SPOOLDIR@
LOCALEDIR	= @VBOX_LOCALE_DIR@

#----------------------------------------------------------------------------#
# The information below should be usable as is. The configure script won't   #
# modify it and you shouldn't need to modify it either.                      #
#----------------------------------------------------------------------------#

TOPDIR		= @srcdir@
VPATH		= @srcdir@

HAVE_NCURSES	= @HAVE_NCURSES_LIBS@
HAVE_TCL        = @HAVE_TCL_LIBS@
HAVE_INTL	= @HAVE_INTL_LIBS@

VBOX_GETTYCONF	= $(sysconfdir)/vboxgetty.conf
VBOX_VBOXDCONF	= $(sysconfdir)/vboxd.conf
VBOX_SYSCONFDIR = $(sysconfdir)
VBOX_BINDIR	= $(bindir)
VBOX_SBINDIR	= $(sbindir)
VBOX_PACKAGE	= @PACKAGE@
VBOX_VERSION	= @VERSION@
VBOX_VERDATE	= @VERDATE@
VBOX_TOPDIR	= $(TOPDIR)
VBOX_CATALOGS	= $(CATALOGS)
VBOX_LOGFILEDIR	= $(LOGFILEDIR)
VBOX_PIDFILEDIR	= $(PIDFILEDIR)
VBOX_LCKFILEDIR	= $(LCKFILEDIR)
VBOX_SPOOLDIR	= $(SPOOLDIR)
VBOX_LOCALEDIR	= $(LOCALEDIR)

#----------------------------------------------------------------------------#
# Export variables needed by the other utilities...                          #
#----------------------------------------------------------------------------#

export CC
export CFLAGS
export LDFLAGS
export AR
export RANLIB
export SED
export VBOX_GETTYCONF
export VBOX_VBOXDCONF
export VBOX_BINDIR
export VBOX_SBINDIR
export VBOX_TOPDIR
export VBOX_CATALOGS
export VBOX_PACKAGE
export VBOX_VERSION
export VBOX_VERDATE
export VBOX_LOGFILEDIR
export VBOX_PIDFILEDIR
export VBOX_LCKFILEDIR
export VBOX_SPOOLDIR
export VBOX_LOCALEDIR
export VBOX_SYSCONFDIR

#----------------------------------------------------------------------------#
# All action we must do...                                                   #
#----------------------------------------------------------------------------#

all:		  vbox-apps vbox-seds

#----------------------------------------------------------------------------#
# Build...                                                                   #
#----------------------------------------------------------------------------#

vbox-apps:	  ignore
		  @$(ECHO)
		  @$(ECHO) "Building vbox $(VBOX_VERSION) ($(VBOX_VERDATE))..."
		  @$(ECHO)
		  @$(MAKE) -C $(TOPDIR)/src all

#----------------------------------------------------------------------------#

SEDCONVERTOBJS	= $(TOPDIR)/utils/vboxmail $(TOPDIR)/utils/vboxplay \
		  $(TOPDIR)/doc/de/txt/vbox.txt \
		  $(TOPDIR)/doc/de/html/vbox.html \
		  $(TOPDIR)/doc/de/html/vbox-1.html \
		  $(TOPDIR)/doc/de/html/vbox-2.html \
		  $(TOPDIR)/doc/de/html/vbox-3.html \
		  $(TOPDIR)/doc/de/html/vbox-4.html \
		  $(TOPDIR)/doc/de/html/vbox-5.html \
		  $(TOPDIR)/doc/de/html/vbox-6.html \
		  $(TOPDIR)/doc/de/html/vbox-7.html \
		  $(TOPDIR)/doc/de/html/vbox-8.html \
		  $(TOPDIR)/doc/de/html/vbox-9.html

vbox-seds:	  ignore
		  @set -e; for i in $(SEDCONVERTOBJS); do \
		     $(TOPDIR)/utils/mksed <$$i.in >$$i; \
		  done

#----------------------------------------------------------------------------#
# Install program & settings...                                              #
#----------------------------------------------------------------------------#

install:	  inst-message \
		  inst-vboxdirs inst-vboxgetty inst-vboxd inst-vbox \
		  inst-vboxcnvt inst-vboxctrl inst-vboxbeep inst-vboxmail \
		  inst-vboxplay inst-vboxmsgs

inst-message:	  ignore
		  @$(ECHO)
		  @$(ECHO) "Installing vbox $(VBOX_VERSION) ($(VBOX_VERDATE))..."
		  @$(ECHO)

#----------------------------------------------------------------------------#

inst-vboxgetty:	  ignore
		  @$(ECHO) "Installing '$(sbindir)/vboxgetty'..."
		  @$(INSTALL_SBIN) $(TOPDIR)/src/vboxgetty $(sbindir)/vboxgetty

		  @$(ECHO) "Installing '$(sysconfdir)/vboxgetty.conf.example'..."
		  @$(INSTALL_SYSCONF) $(TOPDIR)/examples/vboxgetty.conf.example $(sysconfdir)

#----------------------------------------------------------------------------#

inst-vboxd:	  ignore
		  @$(ECHO) "Installing '$(sbindir)/vboxd'..."
		  @$(INSTALL_SBIN) $(TOPDIR)/src/vboxd $(sbindir)/vboxd

		  @$(ECHO) "Installing '$(sysconfdir)/vboxd.conf.example'..."
		  @$(INSTALL_SYSCONF) $(TOPDIR)/examples/vboxd.conf.example $(sysconfdir)

#----------------------------------------------------------------------------#

inst-vboxcnvt:	  ignore
		  @$(ECHO) "Installing '$(bindir)/vboxcnvt'..."
		  @$(INSTALL_BIN) $(TOPDIR)/src/vboxconvert $(bindir)/vboxcnvt
		  @cd $(bindir); \
		  $(LN) -f vboxcnvt vboxtoau; \
		  $(LN) -f vboxcnvt autovbox; \
		  $(LN) -f vboxcnvt vboxmode;

#----------------------------------------------------------------------------#

inst-vboxctrl:	  ignore
		  @$(ECHO) "Installing '$(bindir)/vboxctrl'..."
		  @$(INSTALL_BIN) $(TOPDIR)/src/vboxctrl $(bindir)

#----------------------------------------------------------------------------#

inst-vboxbeep:	  ignore
		  @$(ECHO) "Installing '$(bindir)/vboxbeep'..."
		  @$(INSTALL_UBIN) $(TOPDIR)/src/vboxbeep $(bindir)

#----------------------------------------------------------------------------#

inst-vboxmail:	  ignore
		  @$(ECHO) "Installing '$(bindir)/vboxmail'..."
		  @$(INSTALL_SHBIN) $(TOPDIR)/utils/vboxmail $(bindir)

#----------------------------------------------------------------------------#

inst-vboxplay:	  ignore
		  @$(ECHO) "Installing '$(bindir)/vboxplay'..."
		  @$(INSTALL_SHBIN) $(TOPDIR)/utils/vboxplay $(bindir)

#----------------------------------------------------------------------------#

inst-vbox:	  ignore
ifeq ($(HAVE_NCURSES),y)
		  @$(ECHO) "Installing '$(bindir)/vbox'..."
		  @$(INSTALL_BIN) $(TOPDIR)/src/vbox $(bindir)
endif

#----------------------------------------------------------------------------#

inst-vboxmsgs:	  ignore
		  @set -e; \
		  if [ "$(CATALOGS)" != "" ]; then \
		     for i in $(CATALOGS); do \
		        $(ECHO) "Installing '$(LOCALEDIR)/$$i/LC_MESSAGES/$(VBOX_PACKAGE).mo'..."; \
		        $(INSTALL_LOCALE) $(TOPDIR)/messages/$$i.mo $(LOCALEDIR)/$$i/LC_MESSAGES/$(VBOX_PACKAGE).mo; \
		     done; \
		  fi

#----------------------------------------------------------------------------#
# Uninstall...                                                               #
#----------------------------------------------------------------------------#

uninstall:	  ignore

#----------------------------------------------------------------------------#
# Install directories...                                                     #
#----------------------------------------------------------------------------#

MAKETHISDIRS	= $(prefix) $(exec_prefix) $(sbindir) $(bindir) \
		  $(sysconfdir) $(SPOOLDIR) $(LOGFILEDIR) $(PIDFILEDIR) \
		  $(LCKFILEDIR)

inst-vboxdirs:	  ignore
		  @set -e; \
		  for i in $(MAKETHISDIRS); do \
		     $(ECHO) -n "Checking '$$i'... "; \
		     if [ -d $$i ]; then \
		        $(ECHO) "it's here."; \
		     else \
		        $(ECHO) "creating..."; \
		        $(INSTALL_DIRS) $$i; \
		     fi; \
		  done
		  @set -e; \
		  if [ "$(CATALOGS)" != "" ]; then \
		     for i in $(CATALOGS); do \
		        $(ECHO) -n "Checking '$(LOCALEDIR)/$$i/LC_MESSAGES'... "; \
		        if [ -d $(LOCALEDIR)/$$i/LC_MESSAGES ]; then \
		           $(ECHO) "it's here."; \
		        else \
		           $(ECHO) "creating..."; \
		           $(INSTALL_DIRS) $(LOCALEDIR)/$$i/LC_MESSAGES; \
		        fi; \
		     done; \
		  fi

#----------------------------------------------------------------------------#
# Create sgml source...                                                      #
#----------------------------------------------------------------------------#

create-de-sgml:	  ignore
		  @$(TOPDIR)/utils/mksed <$(TOPDIR)/doc/de/vbox.sgml >$(TOPDIR)/vbox-de.sgml

#----------------------------------------------------------------------------#
# Create po und mo messages (only for development)...                        #
#----------------------------------------------------------------------------#

messages:	  ignore
		  @$(TOPDIR)/utils/mkpos

#----------------------------------------------------------------------------#
# Create documentation (only for development)...                             #
#----------------------------------------------------------------------------#

documents:	  ignore
		  @$(TOPDIR)/utils/mkdoc

#----------------------------------------------------------------------------#
# Create release version (only for development)...                           #
#----------------------------------------------------------------------------#

release:	  distclean messages documents

#----------------------------------------------------------------------------#
# Cleaning...                                                                #
#----------------------------------------------------------------------------#

CLEANSUBDIRS	= $(TOPDIR) $(TOPDIR)/src $(TOPDIR)/doc $(TOPDIR)/utils \
		  $(TOPDIR)/examples $(TOPDIR)/messages \
		  $(TOPDIR)/doc/de $(TOPDIR)/doc/de/html $(TOPDIR)/doc/txt

CLEANOBJS	= $(TOPDIR)/src/vboxgetty $(TOPDIR)/src/vboxd \
		  $(TOPDIR)/src/vboxconvert $(TOPDIR)/src/vboxbeep \
		  $(TOPDIR)/src/vboxctrl $(TOPDIR)/src/vbox

DISTCLEANOBJS	= $(SEDCONVERTOBJS) $(TOPDIR)/Makefile \
		  $(TOPDIR)/src/Makefile $(TOPDIR)/src/config.h \
		  $(TOPDIR)/.Config $(TOPDIR)/config.cache \
		  $(TOPDIR)/config.log $(TOPDIR)/config.status

distclean:	  clean
		  @set -e; for i in $(DISTCLEANOBJS); do \
		     $(RM) -f $$i; \
		  done

clean:		  ignore
		  @set -e; for i in $(CLEANSUBDIRS); do \
		     $(RM) -f $$i/*~ $$i/*.[oas] $$i/backup-*; \
		  done
		  @set -e; for i in $(CLEANOBJS); do \
		     $(RM) -f $$i; \
		  done

#----------------------------------------------------------------------------#
# For isdn4k-utils package compatibility...                                  #
#----------------------------------------------------------------------------#

config:		  ignore
		  @./configure

ignore:

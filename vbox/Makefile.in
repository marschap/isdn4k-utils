#
# $Id: Makefile.in,v 1.9 1997/03/18 12:36:26 michael Exp $

#----------------------------------------------------------------------------#
# Things you can change to personalize the Makefile for your own site. Some  #
# values (eg the directory pathes) are used in some other files too, so do   #
# not change the values by hand - use the options to the configure-script    #
# insteed. Options you can change without configure are marked with [*].     #
#                                                                            #
# Changes to Makefile will get lost if you re-run the configuration script!  #
#----------------------------------------------------------------------------#

#----------------------------------------------------------------------------#
# [*] Program to install binaries to the sbin directory (eg vboxgetty):      #
#----------------------------------------------------------------------------#

INSTALL_SBIN	= @INSTALL@ -m 750 -o root -g root -s

#----------------------------------------------------------------------------#
# [*] Program to install binaries to the bin directory (eg vboxconvert):     #
#----------------------------------------------------------------------------#

INSTALL_BIN	= @INSTALL@ -m 755 -o root -g root -s

#----------------------------------------------------------------------------#
# [*] Program to install bash scripts to the bin directory (eg vboxplay):    #
#----------------------------------------------------------------------------#

INSTALL_SHBIN	= @INSTALL@ -m 755 -o root -g root

#----------------------------------------------------------------------------#
# [*] Program to install binaries to the bin directory and set the suid bit  #
#     (eg vboxbeep):                                                         #
#----------------------------------------------------------------------------#

INSTALL_UBIN	= @INSTALL@ -m 4755 -o root -g root -s

#----------------------------------------------------------------------------#
# [*] Program to install configurations to sysconf directory                 #
#     (eg vboxgetty.conf):                                                   #
#----------------------------------------------------------------------------#

INSTALL_SYSCONF	= @INSTALL@ -m 644 -o root -g root

#----------------------------------------------------------------------------#
# [*] Program to install locales to the locale directory:                    #
#----------------------------------------------------------------------------#

INSTALL_LOCALE	= @INSTALL@ -m 644 -o root -g root

#----------------------------------------------------------------------------#
# [*] Program to create missing directories:                                 #
#----------------------------------------------------------------------------#

INSTALL_DIRS	= @INSTALL@ -d

#----------------------------------------------------------------------------#
# [*] Message catalogs to create. The catalogs must be seperated with space  #
#     (eg: de en fr):                                                        #
#                                                                            #
#     Available catalogs are: de                                             #
#----------------------------------------------------------------------------#

CATALOGS	= @CATALOGS_TO_INSTALL@

#----------------------------------------------------------------------------#
# [*] Compiler to use and flags for the compiler & linker:                   #
#----------------------------------------------------------------------------#

CC		= @CC@
CFLAGS		= @CFLAGS@
LDFLAGS		= @LDFLAGS@

#----------------------------------------------------------------------------#
# [*] Some needed programs:                                                  #
#----------------------------------------------------------------------------#

LN		= @LN_S@
ECHO		= @VBOX_ECHO@
MV		= @VBOX_MV@
RM		= @VBOX_RM@
SED		= @VBOX_SED@
MAILCMD		= @VBOX_MAIL@
AR		= @VBOX_AR@
RANLIB		= @VBOX_RANLIB@

@SET_MAKE@

#----------------------------------------------------------------------------#
# The information below is modified by the configure script when Makefile is #
# generated from Makefile.in. Some of this values are stored in other files  #
# too, so don't change it by hand!                                           #
#----------------------------------------------------------------------------#

prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir		= @bindir@
sbindir		= @sbindir@
sysconfdir	= @sysconfdir@

LOGFILEDIR	= @VBOX_LOGDIR@
PIDFILEDIR	= @VBOX_PIDDIR@
LCKFILEDIR	= @VBOX_LCKDIR@
SPOOLDIR	= @VBOX_SPOOLDIR@
LOCALEDIR	= @VBOX_LOCALE_DIR@

#----------------------------------------------------------------------------#
# The information below should be usable as is. The configure script won't   #
# modify it and you shouldn't need to modify it either.                      #
#----------------------------------------------------------------------------#

TOPDIR		= @srcdir@
VPATH		= @srcdir@

HAVE_NCURSES	= @HAVE_NCURSES_LIBS@
HAVE_TCL        = @HAVE_TCL_LIBS@
HAVE_INTL	= @HAVE_INTL_LIBS@

GETTYRC		= $(sysconfdir)/vboxgetty.conf
VBINDIR		= $(bindir)
PACKAGE		= @PACKAGE@
VERSION		= @VERSION@
VERDATE		= @VERDATE@

#----------------------------------------------------------------------------#
# Export variables needed by the other utilities...                          #
#----------------------------------------------------------------------------#

export CC
export CFLAGS
export LDFLAGS
export AR
export RANLIB
export SED
export GETTYRC
export VBINDIR
export TOPDIR
export CATALOGS
export PACKAGE

#----------------------------------------------------------------------------#
# All action we must do...                                                   #
#----------------------------------------------------------------------------#

all:		  vbox sedconvert

#----------------------------------------------------------------------------#
# vbox                                                                       #
#----------------------------------------------------------------------------#

vbox:		  ignore
		  @$(MAKE) -C $(TOPDIR)/src all

#----------------------------------------------------------------------------#
# sedconvert                                                                 #
#----------------------------------------------------------------------------#

sedconvert:	  ignore
		  @$(TOPDIR)/utils/mksed <$(TOPDIR)/utils/vboxmail.in >$(TOPDIR)/utils/vboxmail
		  @$(TOPDIR)/utils/mksed <$(TOPDIR)/utils/vboxplay.in >$(TOPDIR)/utils/vboxplay

#----------------------------------------------------------------------------#
# install program & settings...                                              #
#----------------------------------------------------------------------------#

install:	  install-dirs

		  @$(ECHO) "Installing '$(sbindir)/vboxgetty'..."
		  @$(INSTALL_SBIN) $(TOPDIR)/src/vboxgetty $(sbindir)/vboxgetty

		  @$(ECHO) "Installing '$(sysconfdir)/vboxgetty.conf.example'..."
		  @$(INSTALL_SYSCONF) $(TOPDIR)/examples/vboxgetty.conf.example $(sysconfdir)

		  @$(ECHO) "Installing '$(bindir)/vboxconvert'..."
		  @$(INSTALL_BIN) $(TOPDIR)/src/vboxconvert $(bindir)
		  @cd $(bindir); \
		  $(LN) -f vboxconvert vboxtoau; \
		  $(LN) -f vboxconvert autovbox; \
		  $(LN) -f vboxconvert vboxmode;

		  @$(ECHO) "Installing '$(bindir)/vboxctrl'..."
		  @$(INSTALL_BIN) $(TOPDIR)/src/vboxctrl $(bindir)

		  @$(ECHO) "Installing '$(bindir)/vboxbeep'..."
		  @$(INSTALL_UBIN) $(TOPDIR)/src/vboxbeep $(bindir)

		  @$(ECHO) "Installing '$(bindir)/vboxmail'..."
		  @$(INSTALL_SHBIN) $(TOPDIR)/utils/vboxmail $(bindir)

		  @$(ECHO) "Installing '$(bindir)/vboxplay'..."
		  @$(INSTALL_SHBIN) $(TOPDIR)/utils/vboxplay $(bindir)

ifeq ($(ACTION_ON_VBOX),y)
		  @$(ECHO) "Installing '$(bindir)/vbox'..."
		  @$(INSTALL_BIN) $(TOPDIR)/src/vbox $(bindir)
endif

		  @set -e; for i in $(CATALOGS); do \
		     $(ECHO) "Installing '$(LOCALEDIR)/$$i/LC_MESSAGES/$(PACKAGE).mo'..."; \
		     $(INSTALL_LOCALE) $(TOPDIR)/messages/$$i.mo $(LOCALEDIR)/$$i/LC_MESSAGES/$(PACKAGE).mo; \
		  done

#----------------------------------------------------------------------------#
# Uninstall...                                                               #
#----------------------------------------------------------------------------#

uninstall:	  ignore

#----------------------------------------------------------------------------#
# Install directories...                                                     #
#----------------------------------------------------------------------------#

MAKETHISDIRS	= $(prefix) $(exec_prefix) $(sbindir) $(bindir) \
		  $(sysconfdir) $(SPOOLDIR) $(LOGFILEDIR) $(PIDFILEDIR) \
		  $(LCKFILEDIR)

install-dirs:	  ignore
		  @set -e; for i in $(MAKETHISDIRS); do \
		     $(ECHO) -n "Checking '$$i'... "; \
		     if [ -d $$i ]; then \
		        $(ECHO) "it's here."; \
		     else \
		        $(ECHO) "creating..."; \
		        $(INSTALL_DIRS) $$i; \
		     fi; \
		  done
		  @set -e; for i in $(CATALOGS); do \
		     $(ECHO) -n "Checking '$(LOCALEDIR)/$$i/LC_MESSAGES'... "; \
		     if [ -d $(LOCALEDIR)/$$i/LC_MESSAGES ]; then \
		        $(ECHO) "it's here."; \
		     else \
		        $(ECHO) "creating..."; \
		        $(INSTALL_DIRS) $(LOCALEDIR)/$$i/LC_MESSAGES; \
		     fi; \
		  done

#----------------------------------------------------------------------------#
# Create po und mo messages (only for development)...                        #
#----------------------------------------------------------------------------#

messages:	  ignore
		  @$(TOPDIR)/utils/mkpos

#----------------------------------------------------------------------------#
# Create release version...                                                  #
#----------------------------------------------------------------------------#

release:	  distclean messages

#----------------------------------------------------------------------------#
# Cleaning...                                                                #
#----------------------------------------------------------------------------#

distclean:	  clean
		  @$(RM) -f $(TOPDIR)/Makefile $(TOPDIR)/src/Makefile \
			    $(TOPDIR)/src/config.h $(TOPDIR)/utils/vboxmail \
			    $(TOPDIR)/utils/vboxplay $(TOPDIR)/.config \
			    $(TOPDIR)/config.cache $(TOPDIR)/config.log \
			    $(TOPDIR)/config.status

clean:		  ignore
		  @$(RM) -f $(TOPDIR)/*~ $(TOPDIR)/src/*~ $(TOPDIR)/doc/*~ \
			    $(TOPDIR)/examples/*~ $(TOPDIR)/utils/*~ \
			    $(TOPDIR)/messages/*~ $(TOPDIR)/messages/backup-* \
			    $(TOPDIR)/src/*.[oas] $(TOPDIR)/src/vboxgetty \
			    $(TOPDIR)/src/vbox $(TOPDIR)/src/vboxconvert \
			    $(TOPDIR)/src/vboxctrl $(TOPDIR)/src/vboxbeep \
			    $(TOPDIR)/doc/*.html $(TOPDIR)/doc/*.sgml \
			    $(TOPDIR)/doc/*.txt

#----------------------------------------------------------------------------#
# For isdn4k-utils package compatibility...                                  #
#----------------------------------------------------------------------------#

config:		  ignore
		  @./configure

ignore:

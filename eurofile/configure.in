dnl Process this file with autoconf to produce a configure script.
dnl $Id: configure.in,v 1.3 1999/06/30 21:05:17 he Exp $

AC_INIT(COPYING.authlib)

#
# Set these according to your preferrences
#
CONFIG_EFTD=${CONFIG_EFTD:-"y"}
# Shall eurofile daemon use authentification modules from wu-ftpd?
CONFIG_EFTD_WUAUTH=${CONFIG_EFTD_WUAUTH:-"y"}
CONFIG_EFTP=${CONFIG_EFTP:-"y"}
# This will be redefined to "n" by the configure script if no readline
# library supporting the alternate interface is found
CONFIG_EFTP_READLINE=${CONFIG_EFTP_READLINE:-"y"}

I4LCONFDIR=`eval echo ${CONFIG_I4LCONFDIR:-"/etc/isdn"}`
I4LCONFFILE=`eval echo ${CONFIG_CONFFILE:-"/etc/isdn"}`
I4LVERSION=${I4LVERSION:-"?.?"}
CONFIG_KERNELDIR=${CONFIG_KERNELDIR:-"/usr/src/linux"}
CONFIG_SBINDIR=${CONFIG_SBINDIR:-"/sbin"}
CONFIG_MANDIR=${CONFIG_MANDIR:-"/usr/man"}

EFT_TOPDIR=${EFT_TOPDIR:-$PWD}

dnl This warning to be inserted in each file generated by configure.
dnl Warning does not apply to this (configure.in) file.

EFT_AUTOCONF_WARNING=".autoconf_warning"

dnl Checks for programs.

AC_PROG_INSTALL
AC_PROG_CC

AC_PATH_PROG(PERL, perl, /usr/bin/perl, /usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/usr/bin:/bin)
AC_PATH_PROG(ISDNCTRL, isdnctrl, /usr/local/sbin/isdnctrl, /usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/usr/bin:/bin)
AC_PATH_PROG(LOOPCTRL, loopctrl, /usr/local/sbin/loopctrl, /usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/usr/bin:/bin)
AC_PATH_PROG(INSMOD, insmod, /sbin/insmod, /usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/usr/bin:/bin)
AC_PATH_PROG(RMMOD, rmmod, /sbin/rmmod, /usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/usr/bin:/bin)
AC_PATH_PROG(IFCONFIG, ifconfig, /sbin/ifconfig, /usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/usr/bin:/bin)
AC_PATH_PROG(X25ROUTE, x25route, /usr/local/sbin/x25route, /usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/usr/bin:/bin)



dnl Checks for libraries.

dnl for command line editing to work, we need a (GNU) readline library
dnl which supports the "alternative interface".

AC_CHECK_LIB(readline,rl_callback_handler_install,,CONFIG_EFTP_READLINE="n",-lncurses)

dnl Checks for header files.

AC_HEADER_STDC
AC_CHECK_HEADERS(fcntl.h sys/ioctl.h unistd.h)

AC_CHECK_HEADERS(linux/isdn.h)
dnl Find current kernel source

dnl Checks for typedefs, structures, and compiler characteristics.


dnl Checks for library functions.


dnl some systems don't contain crypt() in the std C library. Linking servers
dnl with passwd based authentication need -lcrypt in that case.

AC_CHECK_FUNC(crypt,CONFIG_LIBCRYPT="",CONFIG_LIBCRYPT="-lcrypt")

AC_CHECK_FUNC(getdelim,HAVE_GETDELIM="HAVE_GETDELIM",HAVE_GETDELIM="DUMMY")


AC_SUBST(INSTALL)
AC_SUBST(I4LCONFDIR)
AC_SUBST(EFT_TOPDIR)
AC_SUBST_FILE(EFT_AUTOCONF_WARNING)
AC_SUBST(I4LVERSION)
AC_SUBST(CONFIG_KERNELDIR)
AC_SUBST(CONFIG_SBINDIR)
AC_SUBST(CONFIG_MANDIR)
AC_SUBST(CONFIG_LIBCRYPT)
AC_SUBST(CONFIG_EFTP_READLINE)
AC_SUBST(CONFIG_EFTD_WUAUTH)
AC_SUBST(HAVE_GETDELIM)
AC_OUTPUT(scripts/eftp_setup scripts/eftp.sh scripts/eftd.sh 
	src/config.h Rules.make)

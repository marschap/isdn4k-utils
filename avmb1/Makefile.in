# $Id: Makefile.in,v 1.3 1997/03/23 12:03:11 fritz Exp $
#
# Makefile for avmcapictrl
# (C) 1997 Carsten Paeth
#
#
SHELL			= /bin/sh
CFLAGS			= -Wall -O2 -I.
LDFLAGS			= -L../lib @LIBS@
PROGRAMS		=
MODULES			= avmcapictrl.o
MANPAGES		=
INSTALL			= @INSTALL@
INSTALL_PROGRAM	= $(INSTALL) -o 0 -g 0 -m 0750
INSTALL_MAN		= $(INSTALL) -o 0 -g 0 -m 0644
prefix			= @prefix@
exec_prefix		= @exec_prefix@
ifeq (../.config,$(wildcard ../.config))
	include ../.config
	SBINDIR			= $(CONFIG_SBINDIR)
	mandir			= $(CONFIG_MANDIR)
	ifeq ($(CONFIG_AVMCAPICTRL),y)
		PROGRAMS	+= avmcapictrl
		MANPAGES	+= avmcapictrl.8
	endif
else
	MANPAGES		= avmcapictrl.8
	SBINDIR			= /sbin
	mandir			= @mandir@
endif
MAN8DIR			= $(mandir)/man8
CC				= @CC@

%.8: %.man
	cp $< $@

all: $(PROGRAMS) $(MANPAGES)

config:
	@./configure

avmcapictrl:	$(MODULES)
	$(CC) $(CFLAGS) $? $(LDFLAGS) -o $@

install: $(PROGRAMS) $(MANPAGES)
	mkdir -p $(SBINDIR)
	$(INSTALL_PROGRAM) $(PROGRAMS) $(SBINDIR)
	mkdir -p $(MAN8DIR)
	$(INSTALL_MAN) $(MANPAGES) $(MAN8DIR)

install-strip: $(PROGRAMS) $(MANPAGES)
	mkdir -p $(SBINDIR)
	$(INSTALL_PROGRAM) -s $(PROGRAMS) $(SBINDIR)
	mkdir -p $(MAN8DIR)
	$(INSTALL_MAN) $(MANPAGES) $(MAN8DIR)

uninstall:
	@for i in $(PROGRAMS) ; do \
		rm -f $(SBINDIR)/$$i ; \
	done
	@for i in $(MANPAGES) ; do \
		rm -f $(MAN8DIR)/$$i ; \
	done

clean:
	rm -f *.o *~ $(PROGRAMS) *.8

distclean: clean
	rm -f config.status config.cache config.log confdefs.h Makefile *.man
